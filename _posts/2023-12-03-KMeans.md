---
title: KMeans
tags: Machine_Learnig
typora-root-url: ../
---

```python
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.datasets import make_blobs
```


```python
X,y=make_blobs(n_samples=100,centers=3,random_state=10)
```


```python
X=pd.DataFrame(X)
X
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2.324963</td>
      <td>-6.699996</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.518568</td>
      <td>-4.900868</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.443018</td>
      <td>3.846526</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.826623</td>
      <td>-9.922593</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.033002</td>
      <td>5.289908</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>-0.736931</td>
      <td>-4.957402</td>
    </tr>
    <tr>
      <th>96</th>
      <td>2.790440</td>
      <td>3.068621</td>
    </tr>
    <tr>
      <th>97</th>
      <td>4.486980</td>
      <td>-10.074298</td>
    </tr>
    <tr>
      <th>98</th>
      <td>6.268638</td>
      <td>-9.381380</td>
    </tr>
    <tr>
      <th>99</th>
      <td>5.400508</td>
      <td>-9.295867</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div>




```python
y
```




    array([2, 2, 1, 0, 1, 1, 0, 2, 1, 0, 0, 1, 1, 2, 2, 1, 0, 1, 0, 1, 0, 2,
           1, 2, 0, 1, 1, 1, 1, 0, 2, 1, 1, 0, 2, 2, 2, 1, 1, 1, 2, 0, 2, 2,
           1, 0, 0, 0, 2, 0, 1, 2, 0, 0, 2, 0, 1, 2, 0, 0, 1, 1, 2, 2, 2, 0,
           0, 2, 2, 2, 1, 0, 1, 1, 2, 1, 1, 2, 0, 0, 0, 1, 0, 1, 2, 1, 2, 0,
           2, 2, 0, 0, 0, 2, 2, 2, 1, 0, 0, 0])

# 데이터 시각화




```python
sns.scatterplot(x= X[0],y=X[1],hue=y,palette='Set2')
```




    <AxesSubplot:xlabel='0', ylabel='1'>




![output_4_1](/images/2023-12-03-KMeans/output_4_1.png)

# KMeans



```python
from sklearn.cluster import KMeans
```


```python
km  = KMeans(n_clusters=3) # 데이터를 몇개로 나눌 것인가
```


```python
km.fit(X)
```




    KMeans(n_clusters=3)




```python
pred = km.predict(X)
```


```python
sns.scatterplot(x=X[0],y=X[1],hue=pred,palette='Set2')
```




    <AxesSubplot:xlabel='0', ylabel='1'>

![output_9_1](/images/2023-12-03-KMeans/output_9_1.png)

km = KMeans(n_clusters=4)
km.fit(X)
pred = km.predict(X)
sns.scatterplot(x=X[0],y=X[1],hue=pred,palette='Set2')


```python
# 평가값. 각각 cluster안의 중심점으로부터 각 데이터의 거리를 합친값
#멀어지면 멀어질수록 값 커짐
#클러스터 개수가 작아질수록 값 작아짐
# 하나의 클러스터 안에 중심점으로부터 각각의 데이터 거리를 합친값
km.inertia_
```




    186.3658862010144




```python
#만약 클러스터 뭘로 나눠야하는지 모를때
inertia_list=[]
for i in range(2,11):
    km=KMeans(n_clusters=i)
    km.fit(X)
    inertia_list.append(km.inertia_)
```


```python
inertia_list
```




    [976.8773336900745,
     186.3658862010144,
     154.0382001487164,
     130.09644564725255,
     112.82290280054046,
     97.73023773789497,
     85.6477799020984,
     73.22565777242491,
     65.1817669620257]




```python
# 꺽이는 지점이 KMeans의 최적 cluster값
sns.lineplot(x=range(2,11),y=inertia_list)
```




    <AxesSubplot:>




![output_14_1](/images/2023-12-03-KMeans/output_14_1.png)



# 데이터셋 로드

사용 데이터셋: [Marketing Campaign (kaggle.com)](https://www.kaggle.com/datasets/rodsaldanha/arketing-campaign)



```python
mkt_df = pd.read_csv('marketing.csv')
```


```python
mkt_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>...</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5524</td>
      <td>1957</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>58138.0</td>
      <td>0</td>
      <td>0</td>
      <td>04-09-2012</td>
      <td>58</td>
      <td>635</td>
      <td>...</td>
      <td>546</td>
      <td>172</td>
      <td>88</td>
      <td>88</td>
      <td>3</td>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2174</td>
      <td>1954</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>46344.0</td>
      <td>1</td>
      <td>1</td>
      <td>08-03-2014</td>
      <td>38</td>
      <td>11</td>
      <td>...</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4141</td>
      <td>1965</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>71613.0</td>
      <td>0</td>
      <td>0</td>
      <td>21-08-2013</td>
      <td>26</td>
      <td>426</td>
      <td>...</td>
      <td>127</td>
      <td>111</td>
      <td>21</td>
      <td>42</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6182</td>
      <td>1984</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>26646.0</td>
      <td>1</td>
      <td>0</td>
      <td>10-02-2014</td>
      <td>26</td>
      <td>11</td>
      <td>...</td>
      <td>20</td>
      <td>10</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5324</td>
      <td>1981</td>
      <td>PhD</td>
      <td>Married</td>
      <td>58293.0</td>
      <td>1</td>
      <td>0</td>
      <td>19-01-2014</td>
      <td>94</td>
      <td>173</td>
      <td>...</td>
      <td>118</td>
      <td>46</td>
      <td>27</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2235</th>
      <td>10870</td>
      <td>1967</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>61223.0</td>
      <td>0</td>
      <td>1</td>
      <td>13-06-2013</td>
      <td>46</td>
      <td>709</td>
      <td>...</td>
      <td>182</td>
      <td>42</td>
      <td>118</td>
      <td>247</td>
      <td>2</td>
      <td>9</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2236</th>
      <td>4001</td>
      <td>1946</td>
      <td>PhD</td>
      <td>Together</td>
      <td>64014.0</td>
      <td>2</td>
      <td>1</td>
      <td>10-06-2014</td>
      <td>56</td>
      <td>406</td>
      <td>...</td>
      <td>30</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>2</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2237</th>
      <td>7270</td>
      <td>1981</td>
      <td>Graduation</td>
      <td>Divorced</td>
      <td>56981.0</td>
      <td>0</td>
      <td>0</td>
      <td>25-01-2014</td>
      <td>91</td>
      <td>908</td>
      <td>...</td>
      <td>217</td>
      <td>32</td>
      <td>12</td>
      <td>24</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>13</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2238</th>
      <td>8235</td>
      <td>1956</td>
      <td>Master</td>
      <td>Together</td>
      <td>69245.0</td>
      <td>0</td>
      <td>1</td>
      <td>24-01-2014</td>
      <td>8</td>
      <td>428</td>
      <td>...</td>
      <td>214</td>
      <td>80</td>
      <td>30</td>
      <td>61</td>
      <td>2</td>
      <td>6</td>
      <td>5</td>
      <td>10</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2239</th>
      <td>9405</td>
      <td>1954</td>
      <td>PhD</td>
      <td>Married</td>
      <td>52869.0</td>
      <td>1</td>
      <td>1</td>
      <td>15-10-2012</td>
      <td>40</td>
      <td>84</td>
      <td>...</td>
      <td>61</td>
      <td>2</td>
      <td>1</td>
      <td>21</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2240 rows × 21 columns</p>
</div>




```python
pd.set_option('display.max_columns',30)
```


```python
mkt_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5524</td>
      <td>1957</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>58138.0</td>
      <td>0</td>
      <td>0</td>
      <td>04-09-2012</td>
      <td>58</td>
      <td>635</td>
      <td>88</td>
      <td>546</td>
      <td>172</td>
      <td>88</td>
      <td>88</td>
      <td>3</td>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2174</td>
      <td>1954</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>46344.0</td>
      <td>1</td>
      <td>1</td>
      <td>08-03-2014</td>
      <td>38</td>
      <td>11</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4141</td>
      <td>1965</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>71613.0</td>
      <td>0</td>
      <td>0</td>
      <td>21-08-2013</td>
      <td>26</td>
      <td>426</td>
      <td>49</td>
      <td>127</td>
      <td>111</td>
      <td>21</td>
      <td>42</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6182</td>
      <td>1984</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>26646.0</td>
      <td>1</td>
      <td>0</td>
      <td>10-02-2014</td>
      <td>26</td>
      <td>11</td>
      <td>4</td>
      <td>20</td>
      <td>10</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5324</td>
      <td>1981</td>
      <td>PhD</td>
      <td>Married</td>
      <td>58293.0</td>
      <td>1</td>
      <td>0</td>
      <td>19-01-2014</td>
      <td>94</td>
      <td>173</td>
      <td>43</td>
      <td>118</td>
      <td>46</td>
      <td>27</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 성향 비슷한 사람들끼리 분류하는게 목표
mkt_df.drop('ID',axis=1,inplace=True)
```


```python
mkt_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2240 entries, 0 to 2239
    Data columns (total 20 columns):
     #   Column               Non-Null Count  Dtype  
    ---  ------               --------------  -----  
     0   Year_Birth           2240 non-null   int64  
     1   Education            2240 non-null   object 
     2   Marital_Status       2240 non-null   object 
     3   Income               2216 non-null   float64
     4   Kidhome              2240 non-null   int64  
     5   Teenhome             2240 non-null   int64  
     6   Dt_Customer          2240 non-null   object 
     7   Recency              2240 non-null   int64  
     8   MntWines             2240 non-null   int64  
     9   MntFruits            2240 non-null   int64  
     10  MntMeatProducts      2240 non-null   int64  
     11  MntFishProducts      2240 non-null   int64  
     12  MntSweetProducts     2240 non-null   int64  
     13  MntGoldProds         2240 non-null   int64  
     14  NumDealsPurchases    2240 non-null   int64  
     15  NumWebPurchases      2240 non-null   int64  
     16  NumCatalogPurchases  2240 non-null   int64  
     17  NumStorePurchases    2240 non-null   int64  
     18  NumWebVisitsMonth    2240 non-null   int64  
     19  Complain             2240 non-null   int64  
    dtypes: float64(1), int64(16), object(3)
    memory usage: 350.1+ KB



```python
mkt_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2240.000000</td>
      <td>2216.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
      <td>2240.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1968.805804</td>
      <td>52247.251354</td>
      <td>0.444196</td>
      <td>0.506250</td>
      <td>49.109375</td>
      <td>303.935714</td>
      <td>26.302232</td>
      <td>166.950000</td>
      <td>37.525446</td>
      <td>27.062946</td>
      <td>44.021875</td>
      <td>2.325000</td>
      <td>4.084821</td>
      <td>2.662054</td>
      <td>5.790179</td>
      <td>5.316518</td>
      <td>0.009375</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11.984069</td>
      <td>25173.076661</td>
      <td>0.538398</td>
      <td>0.544538</td>
      <td>28.962453</td>
      <td>336.597393</td>
      <td>39.773434</td>
      <td>225.715373</td>
      <td>54.628979</td>
      <td>41.280498</td>
      <td>52.167439</td>
      <td>1.932238</td>
      <td>2.778714</td>
      <td>2.923101</td>
      <td>3.250958</td>
      <td>2.426645</td>
      <td>0.096391</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1893.000000</td>
      <td>1730.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1959.000000</td>
      <td>35303.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>24.000000</td>
      <td>23.750000</td>
      <td>1.000000</td>
      <td>16.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>9.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1970.000000</td>
      <td>51381.500000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>49.000000</td>
      <td>173.500000</td>
      <td>8.000000</td>
      <td>67.000000</td>
      <td>12.000000</td>
      <td>8.000000</td>
      <td>24.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1977.000000</td>
      <td>68522.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>74.000000</td>
      <td>504.250000</td>
      <td>33.000000</td>
      <td>232.000000</td>
      <td>50.000000</td>
      <td>33.000000</td>
      <td>56.000000</td>
      <td>3.000000</td>
      <td>6.000000</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1996.000000</td>
      <td>666666.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>99.000000</td>
      <td>1493.000000</td>
      <td>199.000000</td>
      <td>1725.000000</td>
      <td>259.000000</td>
      <td>263.000000</td>
      <td>362.000000</td>
      <td>15.000000</td>
      <td>27.000000</td>
      <td>28.000000</td>
      <td>13.000000</td>
      <td>20.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
mkt_df.sort_values('Year_Birth')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>239</th>
      <td>1893</td>
      <td>2n Cycle</td>
      <td>Single</td>
      <td>60182.0</td>
      <td>0</td>
      <td>1</td>
      <td>17-05-2014</td>
      <td>23</td>
      <td>8</td>
      <td>0</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>339</th>
      <td>1899</td>
      <td>PhD</td>
      <td>Together</td>
      <td>83532.0</td>
      <td>0</td>
      <td>0</td>
      <td>26-09-2013</td>
      <td>36</td>
      <td>755</td>
      <td>144</td>
      <td>562</td>
      <td>104</td>
      <td>64</td>
      <td>224</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>1900</td>
      <td>2n Cycle</td>
      <td>Divorced</td>
      <td>36640.0</td>
      <td>1</td>
      <td>0</td>
      <td>26-09-2013</td>
      <td>99</td>
      <td>15</td>
      <td>6</td>
      <td>8</td>
      <td>7</td>
      <td>4</td>
      <td>25</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>1940</td>
      <td>PhD</td>
      <td>Single</td>
      <td>51141.0</td>
      <td>0</td>
      <td>0</td>
      <td>08-07-2013</td>
      <td>96</td>
      <td>144</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>424</th>
      <td>1941</td>
      <td>PhD</td>
      <td>Married</td>
      <td>93027.0</td>
      <td>0</td>
      <td>0</td>
      <td>13-04-2013</td>
      <td>77</td>
      <td>1285</td>
      <td>42</td>
      <td>716</td>
      <td>55</td>
      <td>0</td>
      <td>21</td>
      <td>0</td>
      <td>7</td>
      <td>10</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>747</th>
      <td>1995</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>71163.0</td>
      <td>0</td>
      <td>0</td>
      <td>09-03-2014</td>
      <td>30</td>
      <td>283</td>
      <td>17</td>
      <td>372</td>
      <td>138</td>
      <td>106</td>
      <td>44</td>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>12</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1850</th>
      <td>1995</td>
      <td>2n Cycle</td>
      <td>Single</td>
      <td>83257.0</td>
      <td>0</td>
      <td>0</td>
      <td>18-09-2012</td>
      <td>56</td>
      <td>536</td>
      <td>27</td>
      <td>590</td>
      <td>38</td>
      <td>107</td>
      <td>67</td>
      <td>1</td>
      <td>5</td>
      <td>10</td>
      <td>12</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>696</th>
      <td>1995</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>34824.0</td>
      <td>0</td>
      <td>0</td>
      <td>26-03-2014</td>
      <td>65</td>
      <td>4</td>
      <td>2</td>
      <td>11</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1170</th>
      <td>1996</td>
      <td>Basic</td>
      <td>Married</td>
      <td>14421.0</td>
      <td>0</td>
      <td>0</td>
      <td>17-02-2014</td>
      <td>81</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1996</td>
      <td>2n Cycle</td>
      <td>Married</td>
      <td>7500.0</td>
      <td>0</td>
      <td>0</td>
      <td>09-11-2012</td>
      <td>24</td>
      <td>3</td>
      <td>18</td>
      <td>14</td>
      <td>15</td>
      <td>22</td>
      <td>50</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>9</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2240 rows × 20 columns</p>
</div>




```python
mkt_df = mkt_df[mkt_df['Year_Birth']>1900]
```


```python
mkt_df.sort_values('Income',ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2233</th>
      <td>1977</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>666666.0</td>
      <td>1</td>
      <td>0</td>
      <td>02-06-2013</td>
      <td>23</td>
      <td>9</td>
      <td>14</td>
      <td>18</td>
      <td>8</td>
      <td>1</td>
      <td>12</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>617</th>
      <td>1976</td>
      <td>PhD</td>
      <td>Together</td>
      <td>162397.0</td>
      <td>1</td>
      <td>1</td>
      <td>03-06-2013</td>
      <td>31</td>
      <td>85</td>
      <td>1</td>
      <td>16</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>687</th>
      <td>1982</td>
      <td>PhD</td>
      <td>Married</td>
      <td>160803.0</td>
      <td>0</td>
      <td>0</td>
      <td>04-08-2012</td>
      <td>21</td>
      <td>55</td>
      <td>16</td>
      <td>1622</td>
      <td>17</td>
      <td>3</td>
      <td>4</td>
      <td>15</td>
      <td>0</td>
      <td>28</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1300</th>
      <td>1971</td>
      <td>Master</td>
      <td>Together</td>
      <td>157733.0</td>
      <td>1</td>
      <td>0</td>
      <td>04-06-2013</td>
      <td>37</td>
      <td>39</td>
      <td>1</td>
      <td>9</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>164</th>
      <td>1973</td>
      <td>PhD</td>
      <td>Married</td>
      <td>157243.0</td>
      <td>0</td>
      <td>1</td>
      <td>01-03-2014</td>
      <td>98</td>
      <td>20</td>
      <td>2</td>
      <td>1582</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>15</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2078</th>
      <td>1971</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>03-03-2013</td>
      <td>82</td>
      <td>71</td>
      <td>1</td>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2079</th>
      <td>1954</td>
      <td>Master</td>
      <td>Together</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>23-06-2013</td>
      <td>83</td>
      <td>161</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>24</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2081</th>
      <td>1955</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>18-10-2013</td>
      <td>95</td>
      <td>264</td>
      <td>0</td>
      <td>21</td>
      <td>12</td>
      <td>6</td>
      <td>147</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2084</th>
      <td>1943</td>
      <td>Master</td>
      <td>Widow</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>30-10-2013</td>
      <td>75</td>
      <td>532</td>
      <td>126</td>
      <td>490</td>
      <td>164</td>
      <td>126</td>
      <td>126</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2228</th>
      <td>1978</td>
      <td>2n Cycle</td>
      <td>Together</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>12-08-2012</td>
      <td>53</td>
      <td>32</td>
      <td>2</td>
      <td>1607</td>
      <td>12</td>
      <td>4</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2237 rows × 20 columns</p>
</div>




```python
#mkt_df = mkt_df[mkt_df['Income']<200000] 이렇게 하면 NaN값도 모두 지워짐
mkt_df = mkt_df[mkt_df['Income']!=666666.0]
```


```python
mkt_df.sort_values('Income',ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Dt_Customer</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>617</th>
      <td>1976</td>
      <td>PhD</td>
      <td>Together</td>
      <td>162397.0</td>
      <td>1</td>
      <td>1</td>
      <td>03-06-2013</td>
      <td>31</td>
      <td>85</td>
      <td>1</td>
      <td>16</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>687</th>
      <td>1982</td>
      <td>PhD</td>
      <td>Married</td>
      <td>160803.0</td>
      <td>0</td>
      <td>0</td>
      <td>04-08-2012</td>
      <td>21</td>
      <td>55</td>
      <td>16</td>
      <td>1622</td>
      <td>17</td>
      <td>3</td>
      <td>4</td>
      <td>15</td>
      <td>0</td>
      <td>28</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1300</th>
      <td>1971</td>
      <td>Master</td>
      <td>Together</td>
      <td>157733.0</td>
      <td>1</td>
      <td>0</td>
      <td>04-06-2013</td>
      <td>37</td>
      <td>39</td>
      <td>1</td>
      <td>9</td>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>164</th>
      <td>1973</td>
      <td>PhD</td>
      <td>Married</td>
      <td>157243.0</td>
      <td>0</td>
      <td>1</td>
      <td>01-03-2014</td>
      <td>98</td>
      <td>20</td>
      <td>2</td>
      <td>1582</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>15</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1653</th>
      <td>1977</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>157146.0</td>
      <td>0</td>
      <td>0</td>
      <td>29-04-2013</td>
      <td>13</td>
      <td>1</td>
      <td>0</td>
      <td>1725</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>28</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2078</th>
      <td>1971</td>
      <td>Graduation</td>
      <td>Married</td>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>03-03-2013</td>
      <td>82</td>
      <td>71</td>
      <td>1</td>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2079</th>
      <td>1954</td>
      <td>Master</td>
      <td>Together</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>23-06-2013</td>
      <td>83</td>
      <td>161</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>24</td>
      <td>2</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2081</th>
      <td>1955</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>18-10-2013</td>
      <td>95</td>
      <td>264</td>
      <td>0</td>
      <td>21</td>
      <td>12</td>
      <td>6</td>
      <td>147</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2084</th>
      <td>1943</td>
      <td>Master</td>
      <td>Widow</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>30-10-2013</td>
      <td>75</td>
      <td>532</td>
      <td>126</td>
      <td>490</td>
      <td>164</td>
      <td>126</td>
      <td>126</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2228</th>
      <td>1978</td>
      <td>2n Cycle</td>
      <td>Together</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>12-08-2012</td>
      <td>53</td>
      <td>32</td>
      <td>2</td>
      <td>1607</td>
      <td>12</td>
      <td>4</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2236 rows × 20 columns</p>
</div>




```python
mkt_df.isna().mean()
```




    Year_Birth             0.000000
    Education              0.000000
    Marital_Status         0.000000
    Income                 0.010733
    Kidhome                0.000000
    Teenhome               0.000000
    Dt_Customer            0.000000
    Recency                0.000000
    MntWines               0.000000
    MntFruits              0.000000
    MntMeatProducts        0.000000
    MntFishProducts        0.000000
    MntSweetProducts       0.000000
    MntGoldProds           0.000000
    NumDealsPurchases      0.000000
    NumWebPurchases        0.000000
    NumCatalogPurchases    0.000000
    NumStorePurchases      0.000000
    NumWebVisitsMonth      0.000000
    Complain               0.000000
    dtype: float64




```python
mkt_df = mkt_df.dropna()
```


```python
mkt_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 2212 entries, 0 to 2239
    Data columns (total 20 columns):
     #   Column               Non-Null Count  Dtype  
    ---  ------               --------------  -----  
     0   Year_Birth           2212 non-null   int64  
     1   Education            2212 non-null   object 
     2   Marital_Status       2212 non-null   object 
     3   Income               2212 non-null   float64
     4   Kidhome              2212 non-null   int64  
     5   Teenhome             2212 non-null   int64  
     6   Dt_Customer          2212 non-null   object 
     7   Recency              2212 non-null   int64  
     8   MntWines             2212 non-null   int64  
     9   MntFruits            2212 non-null   int64  
     10  MntMeatProducts      2212 non-null   int64  
     11  MntFishProducts      2212 non-null   int64  
     12  MntSweetProducts     2212 non-null   int64  
     13  MntGoldProds         2212 non-null   int64  
     14  NumDealsPurchases    2212 non-null   int64  
     15  NumWebPurchases      2212 non-null   int64  
     16  NumCatalogPurchases  2212 non-null   int64  
     17  NumStorePurchases    2212 non-null   int64  
     18  NumWebVisitsMonth    2212 non-null   int64  
     19  Complain             2212 non-null   int64  
    dtypes: float64(1), int64(16), object(3)
    memory usage: 362.9+ KB



```python
mkt_df['Dt_Customer'] = pd.to_datetime(mkt_df['Dt_Customer'])
```



```python
mkt_df['Dt_Customer'].dt.year.max()
```




    2014




```python
mkt_df['Dt_Customer'].dt.month
```




    0        4
    1        8
    2        8
    3       10
    4        1
            ..
    2235     6
    2236    10
    2237     1
    2238     1
    2239    10
    Name: Dt_Customer, Length: 2212, dtype: int64




```python
mkt_df['Dt_Customer'].dt.year*12 +mkt_df['Dt_Customer'].dt.month
```




    0       24148
    1       24176
    2       24164
    3       24178
    4       24169
            ...  
    2235    24162
    2236    24178
    2237    24169
    2238    24169
    2239    24154
    Name: Dt_Customer, Length: 2212, dtype: int64




```python
mkt_df['pass_age'] = (mkt_df['Dt_Customer'].dt.year.max()*12 +mkt_df['Dt_Customer'].dt.date.max().month)-(mkt_df['Dt_Customer'].dt.year*12+mkt_df['Dt_Customer'].dt.month)
```


```python
mkt_df.drop('Dt_Customer',axis=1,inplace=True)
```


```python
mkt_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
      <th>pass_age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1957</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>58138.0</td>
      <td>0</td>
      <td>0</td>
      <td>58</td>
      <td>635</td>
      <td>88</td>
      <td>546</td>
      <td>172</td>
      <td>88</td>
      <td>88</td>
      <td>3</td>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1954</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>46344.0</td>
      <td>1</td>
      <td>1</td>
      <td>38</td>
      <td>11</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1965</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>71613.0</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>426</td>
      <td>49</td>
      <td>127</td>
      <td>111</td>
      <td>21</td>
      <td>42</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>4</td>
      <td>0</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1984</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>26646.0</td>
      <td>1</td>
      <td>0</td>
      <td>26</td>
      <td>11</td>
      <td>4</td>
      <td>20</td>
      <td>10</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1981</td>
      <td>PhD</td>
      <td>Married</td>
      <td>58293.0</td>
      <td>1</td>
      <td>0</td>
      <td>94</td>
      <td>173</td>
      <td>43</td>
      <td>118</td>
      <td>46</td>
      <td>27</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>




```python
mkt_df['Total_mnt'] = mkt_df[['MntWines','MntFruits','MntMeatProducts','MntFishProducts','MntSweetProducts','MntGoldProds']].sum(axis=1)
```


```python
mkt_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Education</th>
      <th>Marital_Status</th>
      <th>Income</th>
      <th>Kidhome</th>
      <th>Teenhome</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
      <th>pass_age</th>
      <th>Total_mnt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1957</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>58138.0</td>
      <td>0</td>
      <td>0</td>
      <td>58</td>
      <td>635</td>
      <td>88</td>
      <td>546</td>
      <td>172</td>
      <td>88</td>
      <td>88</td>
      <td>3</td>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>32</td>
      <td>1617</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1954</td>
      <td>Graduation</td>
      <td>Single</td>
      <td>46344.0</td>
      <td>1</td>
      <td>1</td>
      <td>38</td>
      <td>11</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>27</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1965</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>71613.0</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>426</td>
      <td>49</td>
      <td>127</td>
      <td>111</td>
      <td>21</td>
      <td>42</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>4</td>
      <td>0</td>
      <td>16</td>
      <td>776</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1984</td>
      <td>Graduation</td>
      <td>Together</td>
      <td>26646.0</td>
      <td>1</td>
      <td>0</td>
      <td>26</td>
      <td>11</td>
      <td>4</td>
      <td>20</td>
      <td>10</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
      <td>53</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1981</td>
      <td>PhD</td>
      <td>Married</td>
      <td>58293.0</td>
      <td>1</td>
      <td>0</td>
      <td>94</td>
      <td>173</td>
      <td>43</td>
      <td>118</td>
      <td>46</td>
      <td>27</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>11</td>
      <td>422</td>
    </tr>
  </tbody>
</table>
</div>




```python
mkt_df['Children'] = mkt_df[['Kidhome','Teenhome']].sum(axis=1)
```


```python
mkt_df.drop(['Kidhome','Teenhome'],axis=1,inplace=True)
```


```python
mkt_df['Marital_Status'].value_counts()
```




    Married     857
    Together    571
    Single      470
    Divorced    231
    Widow        76
    Alone         3
    Absurd        2
    YOLO          2
    Name: Marital_Status, dtype: int64




```python
mkt_df['Marital_Status'] = mkt_df['Marital_Status'].replace({'Married':'Partner','Together':'Partner','Single':'Single','Divorced':'Single','Widow':'Single','Alone':'Single','Absurd':'Single','YOLO':'Single'})
```


```python
mkt_df['Marital_Status'].value_counts()
```




    Partner    1428
    Single      784
    Name: Marital_Status, dtype: int64




```python
mkt_df['Education'].value_counts()
```




    Graduation       1115
    Postgraduate      845
    Undergraduate     198
    Basic              54
    Name: Education, dtype: int64




```python
mkt_df['Education'] = mkt_df['Education'].replace({'Basic':'Basic','2n Cycle':'Basic','Undergraduate':'Basic','Graduation':'Graduation','Master':'Postgraduate','PhD':'Postgraduate'})
```


```python
mkt_df['Education'].value_counts()
```




    Graduation      1115
    Postgraduate     845
    Basic            252
    Name: Education, dtype: int64




```python
mkt_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 2212 entries, 0 to 2239
    Data columns (total 20 columns):
     #   Column               Non-Null Count  Dtype  
    ---  ------               --------------  -----  
     0   Year_Birth           2212 non-null   int64  
     1   Education            2212 non-null   object 
     2   Marital_Status       2212 non-null   object 
     3   Income               2212 non-null   float64
     4   Recency              2212 non-null   int64  
     5   MntWines             2212 non-null   int64  
     6   MntFruits            2212 non-null   int64  
     7   MntMeatProducts      2212 non-null   int64  
     8   MntFishProducts      2212 non-null   int64  
     9   MntSweetProducts     2212 non-null   int64  
     10  MntGoldProds         2212 non-null   int64  
     11  NumDealsPurchases    2212 non-null   int64  
     12  NumWebPurchases      2212 non-null   int64  
     13  NumCatalogPurchases  2212 non-null   int64  
     14  NumStorePurchases    2212 non-null   int64  
     15  NumWebVisitsMonth    2212 non-null   int64  
     16  Complain             2212 non-null   int64  
     17  pass_age             2212 non-null   int64  
     18  Total_mnt            2212 non-null   int64  
     19  Children             2212 non-null   int64  
    dtypes: float64(1), int64(17), object(2)
    memory usage: 362.9+ KB



```python
mkt_df=pd.get_dummies(mkt_df,columns=['Education','Marital_Status'])
```


```python
mkt_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Income</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
      <th>pass_age</th>
      <th>Total_mnt</th>
      <th>Children</th>
      <th>Education_Basic</th>
      <th>Education_Graduation</th>
      <th>Education_Postgraduate</th>
      <th>Marital_Status_Partner</th>
      <th>Marital_Status_Single</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1957</td>
      <td>58138.0</td>
      <td>58</td>
      <td>635</td>
      <td>88</td>
      <td>546</td>
      <td>172</td>
      <td>88</td>
      <td>88</td>
      <td>3</td>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>32</td>
      <td>1617</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1954</td>
      <td>46344.0</td>
      <td>38</td>
      <td>11</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>27</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1965</td>
      <td>71613.0</td>
      <td>26</td>
      <td>426</td>
      <td>49</td>
      <td>127</td>
      <td>111</td>
      <td>21</td>
      <td>42</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>4</td>
      <td>0</td>
      <td>16</td>
      <td>776</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1984</td>
      <td>26646.0</td>
      <td>26</td>
      <td>11</td>
      <td>4</td>
      <td>20</td>
      <td>10</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
      <td>53</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1981</td>
      <td>58293.0</td>
      <td>94</td>
      <td>173</td>
      <td>43</td>
      <td>118</td>
      <td>46</td>
      <td>27</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>11</td>
      <td>422</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



# 스케일링
* 데이터를 특정한 스케일로 통일하는 것
* 데이터를 모델링하기 전에 반드시 스케일링 과정을 거치는 것이 좋음
* 다차원의 값들을 비교 분석하기 쉽게 만들어주며 자료의 오버플로우나 언더플로우를 방지하여 최적화 과정에서의 안전성 및 수렴 속도를 항상

### 스케일링의 종류
1. StandardScaler : 평균과 표준편차 사용
2. MinMaxScaler : 최대/최소값이 각각 0이 되도록 스케일링
3. MaxAbsScaler : 최대절대값과 0이 각각 1, 0 이 되도록 스케일링
4. RobustScaler : 중앙값과 IQR 사용, 아웃라이어의 영향을 최소화 , X-Q2 / Q3-Q1


```python
movie = {'naver':[2,4,6,8,10],'netflix':[1,2,3,4,5]}
```


```python
movie=pd.DataFrame(data=movie)
movie
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>naver</th>
      <th>netflix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
from sklearn.preprocessing import MinMaxScaler, StandardScaler, RobustScaler
```


```python
min_max_scaler = MinMaxScaler()
```


```python
min_max_movie = min_max_scaler.fit_transform(movie)
```


```python
pd.DataFrame(min_max_movie,columns = ['Naver','Netflix'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Naver</th>
      <th>Netflix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.50</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.75</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>




```python
ss =StandardScaler()
```


```python
ss.fit(mkt_df)
```




    StandardScaler()




```python
ss.transform(mkt_df)
```




    array([[-1.01835202,  0.28710487,  0.31035323, ..., -0.78622002,
            -1.34960312,  1.34960312],
           [-1.27478522, -0.26088203, -0.38081349, ..., -0.78622002,
            -1.34960312,  1.34960312],
           [-0.33453017,  0.9131964 , -0.79551352, ..., -0.78622002,
             0.74095857, -0.74095857],
           ...,
           [ 1.03311355,  0.23334696,  1.45077832, ..., -0.78622002,
            -1.34960312,  1.34960312],
           [-1.10382975,  0.80317156, -1.41756357, ...,  1.2719086 ,
             0.74095857, -0.74095857],
           [-1.27478522,  0.04229031, -0.31169682, ...,  1.2719086 ,
             0.74095857, -0.74095857]])




```python
pd.DataFrame(ss.transform(mkt_df))
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.018352</td>
      <td>0.287105</td>
      <td>0.310353</td>
      <td>0.977660</td>
      <td>1.552041</td>
      <td>1.690293</td>
      <td>2.453472</td>
      <td>1.483713</td>
      <td>0.852576</td>
      <td>0.351030</td>
      <td>1.426865</td>
      <td>2.503607</td>
      <td>-0.555814</td>
      <td>0.692181</td>
      <td>-0.09552</td>
      <td>1.936840</td>
      <td>1.676245</td>
      <td>-1.264598</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>-1.349603</td>
      <td>1.349603</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.274785</td>
      <td>-0.260882</td>
      <td>-0.380813</td>
      <td>-0.872618</td>
      <td>-0.637461</td>
      <td>-0.718230</td>
      <td>-0.651004</td>
      <td>-0.634019</td>
      <td>-0.733642</td>
      <td>-0.168701</td>
      <td>-1.126420</td>
      <td>-0.571340</td>
      <td>-1.171160</td>
      <td>-0.132545</td>
      <td>-0.09552</td>
      <td>-1.714136</td>
      <td>-0.963297</td>
      <td>1.404572</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>-1.349603</td>
      <td>1.349603</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.334530</td>
      <td>0.913196</td>
      <td>-0.795514</td>
      <td>0.357935</td>
      <td>0.570540</td>
      <td>-0.178542</td>
      <td>1.339513</td>
      <td>-0.147184</td>
      <td>-0.037254</td>
      <td>-0.688432</td>
      <td>1.426865</td>
      <td>-0.229679</td>
      <td>1.290224</td>
      <td>-0.544908</td>
      <td>-0.09552</td>
      <td>-0.149432</td>
      <td>0.280110</td>
      <td>-1.264598</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.289547</td>
      <td>-1.176114</td>
      <td>-0.795514</td>
      <td>-0.872618</td>
      <td>-0.561961</td>
      <td>-0.655787</td>
      <td>-0.504911</td>
      <td>-0.585335</td>
      <td>-0.752987</td>
      <td>-0.168701</td>
      <td>-0.761665</td>
      <td>-0.913000</td>
      <td>-0.555814</td>
      <td>0.279818</td>
      <td>-0.09552</td>
      <td>-1.974920</td>
      <td>-0.920135</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.033114</td>
      <td>0.294307</td>
      <td>1.554453</td>
      <td>-0.392257</td>
      <td>0.419540</td>
      <td>-0.218684</td>
      <td>0.152508</td>
      <td>-0.001133</td>
      <td>-0.559545</td>
      <td>1.390492</td>
      <td>0.332600</td>
      <td>0.111982</td>
      <td>0.059532</td>
      <td>-0.132545</td>
      <td>-0.09552</td>
      <td>-0.801392</td>
      <td>-0.307562</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2207</th>
      <td>-0.163575</td>
      <td>0.430444</td>
      <td>-0.104347</td>
      <td>1.197084</td>
      <td>0.419540</td>
      <td>0.066770</td>
      <td>0.079461</td>
      <td>2.213965</td>
      <td>3.928291</td>
      <td>-0.168701</td>
      <td>1.791619</td>
      <td>0.111982</td>
      <td>-0.555814</td>
      <td>-0.132545</td>
      <td>-0.09552</td>
      <td>0.111352</td>
      <td>1.218061</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>2208</th>
      <td>-1.958607</td>
      <td>0.560123</td>
      <td>0.241237</td>
      <td>0.298631</td>
      <td>-0.662628</td>
      <td>-0.611184</td>
      <td>-0.687527</td>
      <td>-0.658360</td>
      <td>-0.694954</td>
      <td>2.429954</td>
      <td>1.426865</td>
      <td>-0.229679</td>
      <td>-0.248141</td>
      <td>0.692181</td>
      <td>-0.09552</td>
      <td>-1.974920</td>
      <td>-0.271040</td>
      <td>2.739158</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>2209</th>
      <td>1.033114</td>
      <td>0.233347</td>
      <td>1.450778</td>
      <td>1.787156</td>
      <td>0.545373</td>
      <td>0.222878</td>
      <td>-0.103155</td>
      <td>-0.366260</td>
      <td>-0.385448</td>
      <td>-0.688432</td>
      <td>-0.761665</td>
      <td>0.111982</td>
      <td>2.213242</td>
      <td>0.279818</td>
      <td>-0.09552</td>
      <td>-0.801392</td>
      <td>1.052052</td>
      <td>-1.264598</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>-1.349603</td>
      <td>1.349603</td>
    </tr>
    <tr>
      <th>2210</th>
      <td>-1.103830</td>
      <td>0.803172</td>
      <td>-1.417564</td>
      <td>0.363866</td>
      <td>0.092373</td>
      <td>0.209498</td>
      <td>0.773403</td>
      <td>0.071892</td>
      <td>0.330284</td>
      <td>-0.168701</td>
      <td>0.697355</td>
      <td>0.795303</td>
      <td>1.290224</td>
      <td>-0.957271</td>
      <td>-0.09552</td>
      <td>-0.801392</td>
      <td>0.391336</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>2211</th>
      <td>-1.274785</td>
      <td>0.042290</td>
      <td>-0.311697</td>
      <td>-0.656159</td>
      <td>-0.587128</td>
      <td>-0.472917</td>
      <td>-0.651004</td>
      <td>-0.634019</td>
      <td>-0.443481</td>
      <td>0.351030</td>
      <td>-0.396910</td>
      <td>-0.571340</td>
      <td>-0.555814</td>
      <td>0.692181</td>
      <td>-0.09552</td>
      <td>1.154488</td>
      <td>-0.722584</td>
      <td>1.404572</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
  </tbody>
</table>
<p>2212 rows × 23 columns</p>
</div>




```python
pd.DataFrame(ss.transform(mkt_df),columns=mkt_df.columns)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Income</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
      <th>pass_age</th>
      <th>Total_mnt</th>
      <th>Children</th>
      <th>Education_Basic</th>
      <th>Education_Graduation</th>
      <th>Education_Postgraduate</th>
      <th>Marital_Status_Partner</th>
      <th>Marital_Status_Single</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.018352</td>
      <td>0.287105</td>
      <td>0.310353</td>
      <td>0.977660</td>
      <td>1.552041</td>
      <td>1.690293</td>
      <td>2.453472</td>
      <td>1.483713</td>
      <td>0.852576</td>
      <td>0.351030</td>
      <td>1.426865</td>
      <td>2.503607</td>
      <td>-0.555814</td>
      <td>0.692181</td>
      <td>-0.09552</td>
      <td>1.936840</td>
      <td>1.676245</td>
      <td>-1.264598</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>-1.349603</td>
      <td>1.349603</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.274785</td>
      <td>-0.260882</td>
      <td>-0.380813</td>
      <td>-0.872618</td>
      <td>-0.637461</td>
      <td>-0.718230</td>
      <td>-0.651004</td>
      <td>-0.634019</td>
      <td>-0.733642</td>
      <td>-0.168701</td>
      <td>-1.126420</td>
      <td>-0.571340</td>
      <td>-1.171160</td>
      <td>-0.132545</td>
      <td>-0.09552</td>
      <td>-1.714136</td>
      <td>-0.963297</td>
      <td>1.404572</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>-1.349603</td>
      <td>1.349603</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.334530</td>
      <td>0.913196</td>
      <td>-0.795514</td>
      <td>0.357935</td>
      <td>0.570540</td>
      <td>-0.178542</td>
      <td>1.339513</td>
      <td>-0.147184</td>
      <td>-0.037254</td>
      <td>-0.688432</td>
      <td>1.426865</td>
      <td>-0.229679</td>
      <td>1.290224</td>
      <td>-0.544908</td>
      <td>-0.09552</td>
      <td>-0.149432</td>
      <td>0.280110</td>
      <td>-1.264598</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.289547</td>
      <td>-1.176114</td>
      <td>-0.795514</td>
      <td>-0.872618</td>
      <td>-0.561961</td>
      <td>-0.655787</td>
      <td>-0.504911</td>
      <td>-0.585335</td>
      <td>-0.752987</td>
      <td>-0.168701</td>
      <td>-0.761665</td>
      <td>-0.913000</td>
      <td>-0.555814</td>
      <td>0.279818</td>
      <td>-0.09552</td>
      <td>-1.974920</td>
      <td>-0.920135</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.033114</td>
      <td>0.294307</td>
      <td>1.554453</td>
      <td>-0.392257</td>
      <td>0.419540</td>
      <td>-0.218684</td>
      <td>0.152508</td>
      <td>-0.001133</td>
      <td>-0.559545</td>
      <td>1.390492</td>
      <td>0.332600</td>
      <td>0.111982</td>
      <td>0.059532</td>
      <td>-0.132545</td>
      <td>-0.09552</td>
      <td>-0.801392</td>
      <td>-0.307562</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2207</th>
      <td>-0.163575</td>
      <td>0.430444</td>
      <td>-0.104347</td>
      <td>1.197084</td>
      <td>0.419540</td>
      <td>0.066770</td>
      <td>0.079461</td>
      <td>2.213965</td>
      <td>3.928291</td>
      <td>-0.168701</td>
      <td>1.791619</td>
      <td>0.111982</td>
      <td>-0.555814</td>
      <td>-0.132545</td>
      <td>-0.09552</td>
      <td>0.111352</td>
      <td>1.218061</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>2208</th>
      <td>-1.958607</td>
      <td>0.560123</td>
      <td>0.241237</td>
      <td>0.298631</td>
      <td>-0.662628</td>
      <td>-0.611184</td>
      <td>-0.687527</td>
      <td>-0.658360</td>
      <td>-0.694954</td>
      <td>2.429954</td>
      <td>1.426865</td>
      <td>-0.229679</td>
      <td>-0.248141</td>
      <td>0.692181</td>
      <td>-0.09552</td>
      <td>-1.974920</td>
      <td>-0.271040</td>
      <td>2.739158</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>2209</th>
      <td>1.033114</td>
      <td>0.233347</td>
      <td>1.450778</td>
      <td>1.787156</td>
      <td>0.545373</td>
      <td>0.222878</td>
      <td>-0.103155</td>
      <td>-0.366260</td>
      <td>-0.385448</td>
      <td>-0.688432</td>
      <td>-0.761665</td>
      <td>0.111982</td>
      <td>2.213242</td>
      <td>0.279818</td>
      <td>-0.09552</td>
      <td>-0.801392</td>
      <td>1.052052</td>
      <td>-1.264598</td>
      <td>-0.358569</td>
      <td>0.991895</td>
      <td>-0.786220</td>
      <td>-1.349603</td>
      <td>1.349603</td>
    </tr>
    <tr>
      <th>2210</th>
      <td>-1.103830</td>
      <td>0.803172</td>
      <td>-1.417564</td>
      <td>0.363866</td>
      <td>0.092373</td>
      <td>0.209498</td>
      <td>0.773403</td>
      <td>0.071892</td>
      <td>0.330284</td>
      <td>-0.168701</td>
      <td>0.697355</td>
      <td>0.795303</td>
      <td>1.290224</td>
      <td>-0.957271</td>
      <td>-0.09552</td>
      <td>-0.801392</td>
      <td>0.391336</td>
      <td>0.069987</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
    <tr>
      <th>2211</th>
      <td>-1.274785</td>
      <td>0.042290</td>
      <td>-0.311697</td>
      <td>-0.656159</td>
      <td>-0.587128</td>
      <td>-0.472917</td>
      <td>-0.651004</td>
      <td>-0.634019</td>
      <td>-0.443481</td>
      <td>0.351030</td>
      <td>-0.396910</td>
      <td>-0.571340</td>
      <td>-0.555814</td>
      <td>0.692181</td>
      <td>-0.09552</td>
      <td>1.154488</td>
      <td>-0.722584</td>
      <td>1.404572</td>
      <td>-0.358569</td>
      <td>-1.008171</td>
      <td>1.271909</td>
      <td>0.740959</td>
      <td>-0.740959</td>
    </tr>
  </tbody>
</table>
<p>2212 rows × 23 columns</p>
</div>




```python
rs=RobustScaler()
```


```python
rs_df = pd.DataFrame(rs.fit_transform(mkt_df),columns = mkt_df.columns)
```


```python
rs_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Income</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
      <th>pass_age</th>
      <th>Total_mnt</th>
      <th>Children</th>
      <th>Education_Basic</th>
      <th>Education_Graduation</th>
      <th>Education_Postgraduate</th>
      <th>Marital_Status_Partner</th>
      <th>Marital_Status_Single</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.722222</td>
      <td>0.203497</td>
      <td>0.18</td>
      <td>0.955301</td>
      <td>2.580645</td>
      <td>2.210405</td>
      <td>3.404255</td>
      <td>2.50000</td>
      <td>1.351064</td>
      <td>0.5</td>
      <td>1.00</td>
      <td>2.00</td>
      <td>-0.2</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>1.363636</td>
      <td>1.246170</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.888889</td>
      <td>-0.151172</td>
      <td>-0.22</td>
      <td>-0.341996</td>
      <td>-0.225806</td>
      <td>-0.286705</td>
      <td>-0.212766</td>
      <td>-0.21875</td>
      <td>-0.393617</td>
      <td>0.0</td>
      <td>-0.75</td>
      <td>-0.25</td>
      <td>-0.6</td>
      <td>-0.25</td>
      <td>0.0</td>
      <td>-1.181818</td>
      <td>-0.377937</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.277778</td>
      <td>0.608718</td>
      <td>-0.46</td>
      <td>0.520790</td>
      <td>1.322581</td>
      <td>0.272832</td>
      <td>2.106383</td>
      <td>0.40625</td>
      <td>0.372340</td>
      <td>-0.5</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.0</td>
      <td>-0.50</td>
      <td>0.0</td>
      <td>-0.090909</td>
      <td>0.387130</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.777778</td>
      <td>-0.743531</td>
      <td>-0.46</td>
      <td>-0.341996</td>
      <td>-0.129032</td>
      <td>-0.221965</td>
      <td>-0.042553</td>
      <td>-0.15625</td>
      <td>-0.414894</td>
      <td>0.0</td>
      <td>-0.50</td>
      <td>-0.50</td>
      <td>-0.2</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>-1.363636</td>
      <td>-0.351379</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.611111</td>
      <td>0.208159</td>
      <td>0.90</td>
      <td>-0.005198</td>
      <td>1.129032</td>
      <td>0.231214</td>
      <td>0.723404</td>
      <td>0.59375</td>
      <td>-0.202128</td>
      <td>1.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.2</td>
      <td>-0.25</td>
      <td>0.0</td>
      <td>-0.545455</td>
      <td>0.025536</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2207</th>
      <td>-0.166667</td>
      <td>0.296270</td>
      <td>-0.06</td>
      <td>1.109148</td>
      <td>1.129032</td>
      <td>0.527168</td>
      <td>0.638298</td>
      <td>3.43750</td>
      <td>4.734043</td>
      <td>0.0</td>
      <td>1.25</td>
      <td>0.25</td>
      <td>-0.2</td>
      <td>-0.25</td>
      <td>0.0</td>
      <td>0.090909</td>
      <td>0.964249</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2208</th>
      <td>-1.333333</td>
      <td>0.380201</td>
      <td>0.14</td>
      <td>0.479210</td>
      <td>-0.258065</td>
      <td>-0.175723</td>
      <td>-0.255319</td>
      <td>-0.25000</td>
      <td>-0.351064</td>
      <td>2.5</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>-1.363636</td>
      <td>0.048008</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2209</th>
      <td>0.611111</td>
      <td>0.168704</td>
      <td>0.84</td>
      <td>1.522869</td>
      <td>1.290323</td>
      <td>0.689017</td>
      <td>0.425532</td>
      <td>0.12500</td>
      <td>-0.010638</td>
      <td>-0.5</td>
      <td>-0.50</td>
      <td>0.25</td>
      <td>1.6</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>-0.545455</td>
      <td>0.862104</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2210</th>
      <td>-0.777778</td>
      <td>0.537507</td>
      <td>-0.82</td>
      <td>0.524948</td>
      <td>0.709677</td>
      <td>0.675145</td>
      <td>1.446809</td>
      <td>0.68750</td>
      <td>0.776596</td>
      <td>0.0</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>1.0</td>
      <td>-0.75</td>
      <td>0.0</td>
      <td>-0.545455</td>
      <td>0.455567</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2211</th>
      <td>-0.888889</td>
      <td>0.045048</td>
      <td>-0.18</td>
      <td>-0.190229</td>
      <td>-0.161290</td>
      <td>-0.032370</td>
      <td>-0.212766</td>
      <td>-0.21875</td>
      <td>-0.074468</td>
      <td>0.5</td>
      <td>-0.25</td>
      <td>-0.25</td>
      <td>-0.2</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.818182</td>
      <td>-0.229826</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>2212 rows × 23 columns</p>
</div>




```python
mm = MinMaxScaler()
```


```python
mm_df = pd.DataFrame(mm.fit_transform(mkt_df),columns=mkt_df.columns)
```


```python
inertia_list = []

for i in range(2,11):
    km =KMeans(n_clusters=i,random_state=10)
    km.fit(mm_df)
    inertia_list.append(km.inertia_)
```


```python
inertia_list #얼마만큼 중앙으로부터 떨어져있는지
```




    [2716.565434520096,
     2128.538859847372,
     1800.478678839427,
     1509.0156088906285,
     1359.9005020585553,
     1248.8212584290616,
     1149.9546855336653,
     1086.2808493686614,
     1001.6000404612497]




```python
sns.lineplot(x=range(2,11),y=inertia_list) #엘보우가 확실하지 않음
```




    <AxesSubplot:>




![output_70_1](/images/2023-12-03-KMeans/output_70_1.png)



```python
from sklearn.metrics import silhouette_score #엘보우가 보이지 않을 때 쓰는 방법
```


```python
score =[]

for i in range(2,11):
    km =KMeans(n_clusters=i,random_state=10)
    km.fit(mm_df)
    pred = km.predict(mm_df)
    score.append(silhouette_score(mm_df,pred))
```


```python
score
```




    [0.28386453983057247,
     0.2887413590601001,
     0.3351466205710323,
     0.38701939705865523,
     0.33873983436452154,
     0.35943321311348714,
     0.3320185992018463,
     0.32257570534101726,
     0.3130792078445861]




```python
sns.lineplot(x=range(2,11),y=score) # 가장 점수 높은 값이 클러스터 값
```




    <AxesSubplot:>




![output_74_1](/images/2023-12-03-KMeans/output_74_1.png)



```python
km = KMeans(n_clusters=5, random_state= 10)
```


```python
km.fit(mm_df)
```




    KMeans(n_clusters=5, random_state=10)




```python
pred = km.predict(mm_df)
```


```python
pred
```




    array([0, 0, 2, ..., 0, 1, 1])




```python
mkt_df['label'] =pred
```


```python
mkt_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_Birth</th>
      <th>Income</th>
      <th>Recency</th>
      <th>MntWines</th>
      <th>MntFruits</th>
      <th>MntMeatProducts</th>
      <th>MntFishProducts</th>
      <th>MntSweetProducts</th>
      <th>MntGoldProds</th>
      <th>NumDealsPurchases</th>
      <th>NumWebPurchases</th>
      <th>NumCatalogPurchases</th>
      <th>NumStorePurchases</th>
      <th>NumWebVisitsMonth</th>
      <th>Complain</th>
      <th>pass_age</th>
      <th>Total_mnt</th>
      <th>Children</th>
      <th>Education_Basic</th>
      <th>Education_Graduation</th>
      <th>Education_Postgraduate</th>
      <th>Marital_Status_Partner</th>
      <th>Marital_Status_Single</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1957</td>
      <td>58138.0</td>
      <td>58</td>
      <td>635</td>
      <td>88</td>
      <td>546</td>
      <td>172</td>
      <td>88</td>
      <td>88</td>
      <td>3</td>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>32</td>
      <td>1617</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1954</td>
      <td>46344.0</td>
      <td>38</td>
      <td>11</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>27</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1965</td>
      <td>71613.0</td>
      <td>26</td>
      <td>426</td>
      <td>49</td>
      <td>127</td>
      <td>111</td>
      <td>21</td>
      <td>42</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>10</td>
      <td>4</td>
      <td>0</td>
      <td>16</td>
      <td>776</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1984</td>
      <td>26646.0</td>
      <td>26</td>
      <td>11</td>
      <td>4</td>
      <td>20</td>
      <td>10</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>6</td>
      <td>0</td>
      <td>2</td>
      <td>53</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1981</td>
      <td>58293.0</td>
      <td>94</td>
      <td>173</td>
      <td>43</td>
      <td>118</td>
      <td>46</td>
      <td>27</td>
      <td>15</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>11</td>
      <td>422</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
mkt_df['label'].value_counts()
```




    2    713
    1    545
    0    402
    3    300
    4    252
    Name: label, dtype: int64




```python

```
