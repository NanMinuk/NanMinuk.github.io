---
title: LightBGM
tags: Machine_Learnig
typora-root-url: ../
---

```python
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
%matplotlib inline
```


```python
credit_df = pd.read_csv('credit.csv')
```


```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Customer_ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>SSN</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>...</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0x1602</td>
      <td>CUS_0xd40</td>
      <td>Aaron Maashoh</td>
      <td>23</td>
      <td>821-00-0265</td>
      <td>Scientist</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>...</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>22 Years and 1 Months</td>
      <td>No</td>
      <td>49.574949</td>
      <td>80.41529544</td>
      <td>High_spent_Small_value_payments</td>
      <td>312.494089</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0x160e</td>
      <td>CUS_0x21b1</td>
      <td>Rick Rothackerj</td>
      <td>28_</td>
      <td>004-07-5839</td>
      <td>_______</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>...</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>26 Years and 7 Months</td>
      <td>No</td>
      <td>18.816215</td>
      <td>104.2918252</td>
      <td>Low_spent_Small_value_payments</td>
      <td>470.690627</td>
      <td>Standard</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0x161a</td>
      <td>CUS_0x2dbc</td>
      <td>Langep</td>
      <td>34</td>
      <td>486-85-3974</td>
      <td>_______</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>...</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>17 Years and 9 Months</td>
      <td>No</td>
      <td>246.992320</td>
      <td>168.4137027</td>
      <td>!@9#%8</td>
      <td>1043.315978</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0x1626</td>
      <td>CUS_0xb891</td>
      <td>Jasond</td>
      <td>54</td>
      <td>072-31-6145</td>
      <td>Entrepreneur</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>...</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>17 Years and 3 Months</td>
      <td>No</td>
      <td>16.415452</td>
      <td>81.22885871</td>
      <td>Low_spent_Large_value_payments</td>
      <td>433.604773</td>
      <td>Standard</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0x1632</td>
      <td>CUS_0x1cdb</td>
      <td>Deepaa</td>
      <td>21</td>
      <td>615-06-7821</td>
      <td>Developer</td>
      <td>35547.71_</td>
      <td>7</td>
      <td>5</td>
      <td>5</td>
      <td>...</td>
      <td>4.0</td>
      <td>943.86</td>
      <td>39.797764</td>
      <td>30 Years and 8 Months</td>
      <td>Yes</td>
      <td>0.000000</td>
      <td>276.7253943</td>
      <td>!@9#%8</td>
      <td>288.605522</td>
      <td>Standard</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>




```python
pd.set_option('display.max_columns',30)
```


```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Customer_ID</th>
      <th>Name</th>
      <th>Age</th>
      <th>SSN</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0x1602</td>
      <td>CUS_0xd40</td>
      <td>Aaron Maashoh</td>
      <td>23</td>
      <td>821-00-0265</td>
      <td>Scientist</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>Auto Loan, Credit-Builder Loan, Personal Loan,...</td>
      <td>3</td>
      <td>7</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>22 Years and 1 Months</td>
      <td>No</td>
      <td>49.574949</td>
      <td>80.41529544</td>
      <td>High_spent_Small_value_payments</td>
      <td>312.494089</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0x160e</td>
      <td>CUS_0x21b1</td>
      <td>Rick Rothackerj</td>
      <td>28_</td>
      <td>004-07-5839</td>
      <td>_______</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>Credit-Builder Loan</td>
      <td>3</td>
      <td>4</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>26 Years and 7 Months</td>
      <td>No</td>
      <td>18.816215</td>
      <td>104.2918252</td>
      <td>Low_spent_Small_value_payments</td>
      <td>470.690627</td>
      <td>Standard</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0x161a</td>
      <td>CUS_0x2dbc</td>
      <td>Langep</td>
      <td>34</td>
      <td>486-85-3974</td>
      <td>_______</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>Auto Loan, Auto Loan, and Not Specified</td>
      <td>5</td>
      <td>8</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>17 Years and 9 Months</td>
      <td>No</td>
      <td>246.992320</td>
      <td>168.4137027</td>
      <td>!@9#%8</td>
      <td>1043.315978</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0x1626</td>
      <td>CUS_0xb891</td>
      <td>Jasond</td>
      <td>54</td>
      <td>072-31-6145</td>
      <td>Entrepreneur</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>Not Specified</td>
      <td>0</td>
      <td>6</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>17 Years and 3 Months</td>
      <td>No</td>
      <td>16.415452</td>
      <td>81.22885871</td>
      <td>Low_spent_Large_value_payments</td>
      <td>433.604773</td>
      <td>Standard</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0x1632</td>
      <td>CUS_0x1cdb</td>
      <td>Deepaa</td>
      <td>21</td>
      <td>615-06-7821</td>
      <td>Developer</td>
      <td>35547.71_</td>
      <td>7</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>943.86</td>
      <td>39.797764</td>
      <td>30 Years and 8 Months</td>
      <td>Yes</td>
      <td>0.000000</td>
      <td>276.7253943</td>
      <td>!@9#%8</td>
      <td>288.605522</td>
      <td>Standard</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df.drop(['ID','Customer_ID','Name','SSN'],axis=1,inplace=True)
```


```python
credit_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 12500 entries, 0 to 12499
    Data columns (total 20 columns):
     #   Column                    Non-Null Count  Dtype  
    ---  ------                    --------------  -----  
     0   Age                       12500 non-null  object 
     1   Occupation                12500 non-null  object 
     2   Annual_Income             12500 non-null  object 
     3   Num_Bank_Accounts         12500 non-null  int64  
     4   Num_Credit_Card           12500 non-null  int64  
     5   Interest_Rate             12500 non-null  int64  
     6   Num_of_Loan               12500 non-null  object 
     7   Type_of_Loan              11074 non-null  object 
     8   Delay_from_due_date       12500 non-null  int64  
     9   Num_of_Delayed_Payment    11657 non-null  object 
     10  Num_Credit_Inquiries      12264 non-null  float64
     11  Outstanding_Debt          12500 non-null  object 
     12  Credit_Utilization_Ratio  12500 non-null  float64
     13  Credit_History_Age        11387 non-null  object 
     14  Payment_of_Min_Amount     12500 non-null  object 
     15  Total_EMI_per_month       12500 non-null  float64
     16  Amount_invested_monthly   11935 non-null  object 
     17  Payment_Behaviour         12500 non-null  object 
     18  Monthly_Balance           12366 non-null  float64
     19  Credit_Score              12500 non-null  object 
    dtypes: float64(4), int64(4), object(12)
    memory usage: 1.9+ MB
    


```python
credit_df['Credit_Score'].value_counts()
```




    Standard    6943
    Poor        3582
    Good        1975
    Name: Credit_Score, dtype: int64




```python
credit_df['Credit_Score'] = credit_df['Credit_Score'].replace({'Poor':0,'Standard':1,'Good':2})
```


```python
credit_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Delay_from_due_date</th>
      <th>Num_Credit_Inquiries</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Total_EMI_per_month</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12500.000000</td>
      <td>12500.000000</td>
      <td>12500.00000</td>
      <td>12500.000000</td>
      <td>12264.000000</td>
      <td>12500.000000</td>
      <td>12500.000000</td>
      <td>12366.000000</td>
      <td>12500.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>17.275120</td>
      <td>21.647680</td>
      <td>69.46520</td>
      <td>21.051440</td>
      <td>24.591650</td>
      <td>32.291949</td>
      <td>1303.781040</td>
      <td>405.815391</td>
      <td>0.871440</td>
    </tr>
    <tr>
      <th>std</th>
      <td>118.518214</td>
      <td>123.789969</td>
      <td>455.95698</td>
      <td>14.859994</td>
      <td>183.422458</td>
      <td>5.084327</td>
      <td>8118.261086</td>
      <td>218.136964</td>
      <td>0.654268</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>-5.000000</td>
      <td>0.000000</td>
      <td>20.992914</td>
      <td>0.000000</td>
      <td>0.088628</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>8.00000</td>
      <td>10.000000</td>
      <td>2.000000</td>
      <td>28.110034</td>
      <td>29.128806</td>
      <td>271.785749</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>13.00000</td>
      <td>18.000000</td>
      <td>4.000000</td>
      <td>32.297912</td>
      <td>66.372879</td>
      <td>337.169588</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>20.00000</td>
      <td>28.000000</td>
      <td>8.000000</td>
      <td>36.458660</td>
      <td>149.904496</td>
      <td>475.222487</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1779.000000</td>
      <td>1479.000000</td>
      <td>5788.00000</td>
      <td>67.000000</td>
      <td>2592.000000</td>
      <td>49.564519</td>
      <td>82122.000000</td>
      <td>1602.040519</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
sns.barplot(x='Payment_of_Min_Amount',y='Credit_Score',data=credit_df)
```




    <AxesSubplot:xlabel='Payment_of_Min_Amount', ylabel='Credit_Score'>




![png](output_10_1.png)



```python
plt.figure(figsize = (20,5))
sns.barplot(x='Occupation',y='Credit_Score',data=credit_df)
```




    <AxesSubplot:xlabel='Occupation', ylabel='Credit_Score'>




![png](output_11_1.png)



```python
plt.figure(figsize= (15,15))
sns.heatmap(credit_df.corr(),cmap='coolwarm',vmin=-1,vmax=1,annot=True)
#색깔 두드러져있는것이 연관성 높음
```




    <AxesSubplot:>




![png](output_12_1.png)



```python
credit_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 12500 entries, 0 to 12499
    Data columns (total 20 columns):
     #   Column                    Non-Null Count  Dtype  
    ---  ------                    --------------  -----  
     0   Age                       12500 non-null  object 
     1   Occupation                12500 non-null  object 
     2   Annual_Income             12500 non-null  object 
     3   Num_Bank_Accounts         12500 non-null  int64  
     4   Num_Credit_Card           12500 non-null  int64  
     5   Interest_Rate             12500 non-null  int64  
     6   Num_of_Loan               12500 non-null  object 
     7   Type_of_Loan              11074 non-null  object 
     8   Delay_from_due_date       12500 non-null  int64  
     9   Num_of_Delayed_Payment    11657 non-null  object 
     10  Num_Credit_Inquiries      12264 non-null  float64
     11  Outstanding_Debt          12500 non-null  object 
     12  Credit_Utilization_Ratio  12500 non-null  float64
     13  Credit_History_Age        11387 non-null  object 
     14  Payment_of_Min_Amount     12500 non-null  object 
     15  Total_EMI_per_month       12500 non-null  float64
     16  Amount_invested_monthly   11935 non-null  object 
     17  Payment_Behaviour         12500 non-null  object 
     18  Monthly_Balance           12366 non-null  float64
     19  Credit_Score              12500 non-null  int64  
    dtypes: float64(4), int64(5), object(11)
    memory usage: 1.9+ MB
    


```python
for i in credit_df.columns:
    #print(i,credit_df[i].dtype)
    if credit_df[i].dtype=='O':
        print(i)
```

    Age
    Occupation
    Annual_Income
    Num_of_Loan
    Type_of_Loan
    Num_of_Delayed_Payment
    Outstanding_Debt
    Credit_History_Age
    Payment_of_Min_Amount
    Amount_invested_monthly
    Payment_Behaviour
    


```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23</td>
      <td>Scientist</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>Auto Loan, Credit-Builder Loan, Personal Loan,...</td>
      <td>3</td>
      <td>7</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>22 Years and 1 Months</td>
      <td>No</td>
      <td>49.574949</td>
      <td>80.41529544</td>
      <td>High_spent_Small_value_payments</td>
      <td>312.494089</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28_</td>
      <td>_______</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>Credit-Builder Loan</td>
      <td>3</td>
      <td>4</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>26 Years and 7 Months</td>
      <td>No</td>
      <td>18.816215</td>
      <td>104.2918252</td>
      <td>Low_spent_Small_value_payments</td>
      <td>470.690627</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>_______</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>Auto Loan, Auto Loan, and Not Specified</td>
      <td>5</td>
      <td>8</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>17 Years and 9 Months</td>
      <td>No</td>
      <td>246.992320</td>
      <td>168.4137027</td>
      <td>!@9#%8</td>
      <td>1043.315978</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54</td>
      <td>Entrepreneur</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>Not Specified</td>
      <td>0</td>
      <td>6</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>17 Years and 3 Months</td>
      <td>No</td>
      <td>16.415452</td>
      <td>81.22885871</td>
      <td>Low_spent_Large_value_payments</td>
      <td>433.604773</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>Developer</td>
      <td>35547.71_</td>
      <td>7</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>943.86</td>
      <td>39.797764</td>
      <td>30 Years and 8 Months</td>
      <td>Yes</td>
      <td>0.000000</td>
      <td>276.7253943</td>
      <td>!@9#%8</td>
      <td>288.605522</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
for i in ['Age','Annual_Income','Num_of_Loan','Num_of_Delayed_Payment','Outstanding_Debt','Amount_invested_monthly']:
    credit_df[i]=pd.to_numeric(credit_df[i].str.replace('_',''))
```


```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23</td>
      <td>Scientist</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>Auto Loan, Credit-Builder Loan, Personal Loan,...</td>
      <td>3</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>22 Years and 1 Months</td>
      <td>No</td>
      <td>49.574949</td>
      <td>80.415295</td>
      <td>High_spent_Small_value_payments</td>
      <td>312.494089</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28</td>
      <td>_______</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>Credit-Builder Loan</td>
      <td>3</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>26 Years and 7 Months</td>
      <td>No</td>
      <td>18.816215</td>
      <td>104.291825</td>
      <td>Low_spent_Small_value_payments</td>
      <td>470.690627</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>_______</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>Auto Loan, Auto Loan, and Not Specified</td>
      <td>5</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>17 Years and 9 Months</td>
      <td>No</td>
      <td>246.992320</td>
      <td>168.413703</td>
      <td>!@9#%8</td>
      <td>1043.315978</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54</td>
      <td>Entrepreneur</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>Not Specified</td>
      <td>0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>17 Years and 3 Months</td>
      <td>No</td>
      <td>16.415452</td>
      <td>81.228859</td>
      <td>Low_spent_Large_value_payments</td>
      <td>433.604773</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>Developer</td>
      <td>35547.71</td>
      <td>7</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>943.86</td>
      <td>39.797764</td>
      <td>30 Years and 8 Months</td>
      <td>Yes</td>
      <td>0.000000</td>
      <td>276.725394</td>
      <td>!@9#%8</td>
      <td>288.605522</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 12500 entries, 0 to 12499
    Data columns (total 20 columns):
     #   Column                    Non-Null Count  Dtype  
    ---  ------                    --------------  -----  
     0   Age                       12500 non-null  int64  
     1   Occupation                12500 non-null  object 
     2   Annual_Income             12500 non-null  float64
     3   Num_Bank_Accounts         12500 non-null  int64  
     4   Num_Credit_Card           12500 non-null  int64  
     5   Interest_Rate             12500 non-null  int64  
     6   Num_of_Loan               12500 non-null  int64  
     7   Type_of_Loan              11074 non-null  object 
     8   Delay_from_due_date       12500 non-null  int64  
     9   Num_of_Delayed_Payment    11657 non-null  float64
     10  Num_Credit_Inquiries      12264 non-null  float64
     11  Outstanding_Debt          12500 non-null  float64
     12  Credit_Utilization_Ratio  12500 non-null  float64
     13  Credit_History_Age        11387 non-null  object 
     14  Payment_of_Min_Amount     12500 non-null  object 
     15  Total_EMI_per_month       12500 non-null  float64
     16  Amount_invested_monthly   11935 non-null  float64
     17  Payment_Behaviour         12500 non-null  object 
     18  Monthly_Balance           12366 non-null  float64
     19  Credit_Score              12500 non-null  int64  
    dtypes: float64(8), int64(7), object(5)
    memory usage: 1.9+ MB
    


```python
# 22 Years and 1 Months -> 
credit_df['Credit_History_Age']=credit_df['Credit_History_Age'].str.replace(' Months','')
```


```python
# 22 Years and 1
credit_df['Credit_History_Age'] = pd.to_numeric(credit_df['Credit_History_Age'].str.split(' Years and ', expand=True)[0]) * 12 + pd.to_numeric(credit_df['Credit_History_Age'].str.split(' Years and ', expand=True)[1])
```


```python
credit_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12500.000000</td>
      <td>1.250000e+04</td>
      <td>12500.000000</td>
      <td>12500.000000</td>
      <td>12500.00000</td>
      <td>12500.00000</td>
      <td>12500.000000</td>
      <td>11657.000000</td>
      <td>12264.000000</td>
      <td>12500.000000</td>
      <td>12500.000000</td>
      <td>11387.000000</td>
      <td>12500.000000</td>
      <td>11935.000000</td>
      <td>12366.000000</td>
      <td>12500.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>113.371280</td>
      <td>1.888617e+05</td>
      <td>17.275120</td>
      <td>21.647680</td>
      <td>69.46520</td>
      <td>3.43656</td>
      <td>21.051440</td>
      <td>31.280089</td>
      <td>24.591650</td>
      <td>1426.220376</td>
      <td>32.291949</td>
      <td>217.588127</td>
      <td>1303.781040</td>
      <td>643.291976</td>
      <td>405.815391</td>
      <td>0.871440</td>
    </tr>
    <tr>
      <th>std</th>
      <td>691.223297</td>
      <td>1.482707e+06</td>
      <td>118.518214</td>
      <td>123.789969</td>
      <td>455.95698</td>
      <td>65.35565</td>
      <td>14.859994</td>
      <td>229.911798</td>
      <td>183.422458</td>
      <td>1155.169458</td>
      <td>5.084327</td>
      <td>99.638681</td>
      <td>8118.261086</td>
      <td>2063.324328</td>
      <td>218.136964</td>
      <td>0.654268</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-500.000000</td>
      <td>7.005930e+03</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>-100.00000</td>
      <td>-5.000000</td>
      <td>-3.000000</td>
      <td>0.000000</td>
      <td>0.230000</td>
      <td>20.992914</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.088628</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>24.000000</td>
      <td>1.948777e+04</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>8.00000</td>
      <td>1.00000</td>
      <td>10.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>566.072500</td>
      <td>28.110034</td>
      <td>141.000000</td>
      <td>29.128806</td>
      <td>73.810753</td>
      <td>271.785749</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.000000</td>
      <td>3.765508e+04</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>13.00000</td>
      <td>3.00000</td>
      <td>18.000000</td>
      <td>14.000000</td>
      <td>4.000000</td>
      <td>1166.155000</td>
      <td>32.297912</td>
      <td>215.000000</td>
      <td>66.372879</td>
      <td>134.201478</td>
      <td>337.169588</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>42.000000</td>
      <td>7.289813e+04</td>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>20.00000</td>
      <td>5.00000</td>
      <td>28.000000</td>
      <td>18.000000</td>
      <td>8.000000</td>
      <td>1945.962500</td>
      <td>36.458660</td>
      <td>298.000000</td>
      <td>149.904496</td>
      <td>264.555831</td>
      <td>475.222487</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>8592.000000</td>
      <td>2.365819e+07</td>
      <td>1779.000000</td>
      <td>1479.000000</td>
      <td>5788.00000</td>
      <td>1496.00000</td>
      <td>67.000000</td>
      <td>4388.000000</td>
      <td>2592.000000</td>
      <td>4998.070000</td>
      <td>49.564519</td>
      <td>397.000000</td>
      <td>82122.000000</td>
      <td>10000.000000</td>
      <td>1602.040519</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df = credit_df[credit_df['Age']>=0]
```


```python
credit_df.sort_values('Age').tail(30) #나이가 이상?...
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9449</th>
      <td>7615</td>
      <td>Architect</td>
      <td>34589.720</td>
      <td>6</td>
      <td>9</td>
      <td>25</td>
      <td>5</td>
      <td>Personal Loan, Student Loan, Home Equity Loan,...</td>
      <td>23</td>
      <td>18.0</td>
      <td>8.0</td>
      <td>3783.35</td>
      <td>32.711927</td>
      <td>65.0</td>
      <td>Yes</td>
      <td>111.689044</td>
      <td>128.119632</td>
      <td>High_spent_Small_value_payments</td>
      <td>318.438990</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7151</th>
      <td>7711</td>
      <td>Manager</td>
      <td>15814.770</td>
      <td>7</td>
      <td>4</td>
      <td>13</td>
      <td>7</td>
      <td>Debt Consolidation Loan, Not Specified, Home E...</td>
      <td>22</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>902.47</td>
      <td>39.316759</td>
      <td>233.0</td>
      <td>NM</td>
      <td>58.119995</td>
      <td>10000.000000</td>
      <td>Low_spent_Small_value_payments</td>
      <td>190.621479</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8974</th>
      <td>7733</td>
      <td>Doctor</td>
      <td>21505.640</td>
      <td>2</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>Not Specified</td>
      <td>4</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>204.35</td>
      <td>35.150663</td>
      <td>184.0</td>
      <td>No</td>
      <td>11.620501</td>
      <td>55.276752</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>367.916413</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11565</th>
      <td>7753</td>
      <td>_______</td>
      <td>19826.670</td>
      <td>6</td>
      <td>3</td>
      <td>33</td>
      <td>5</td>
      <td>Student Loan, Home Equity Loan, Personal Loan,...</td>
      <td>6</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>2052.89</td>
      <td>35.653249</td>
      <td>64.0</td>
      <td>Yes</td>
      <td>45.868928</td>
      <td>121.807133</td>
      <td>Low_spent_Small_value_payments</td>
      <td>302.846189</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6851</th>
      <td>7762</td>
      <td>Journalist</td>
      <td>43549.860</td>
      <td>7</td>
      <td>5</td>
      <td>24</td>
      <td>9</td>
      <td>Student Loan, Debt Consolidation Loan, Mortgag...</td>
      <td>27</td>
      <td>21.0</td>
      <td>6.0</td>
      <td>4639.59</td>
      <td>28.221137</td>
      <td>145.0</td>
      <td>Yes</td>
      <td>193.114379</td>
      <td>96.851718</td>
      <td>High_spent_Small_value_payments</td>
      <td>337.249403</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9388</th>
      <td>7849</td>
      <td>Doctor</td>
      <td>66554.310</td>
      <td>4</td>
      <td>6</td>
      <td>15</td>
      <td>3</td>
      <td>Payday Loan, Credit-Builder Loan, and Auto Loan</td>
      <td>14</td>
      <td>19.0</td>
      <td>3.0</td>
      <td>485.70</td>
      <td>33.200830</td>
      <td>223.0</td>
      <td>No</td>
      <td>101.923115</td>
      <td>349.739377</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>402.756758</td>
      <td>1</td>
    </tr>
    <tr>
      <th>565</th>
      <td>7851</td>
      <td>Engineer</td>
      <td>20083.060</td>
      <td>8</td>
      <td>5</td>
      <td>15</td>
      <td>3</td>
      <td>Credit-Builder Loan, Mortgage Loan, and Credit...</td>
      <td>20</td>
      <td>23.0</td>
      <td>7.0</td>
      <td>2381.47</td>
      <td>37.416601</td>
      <td>107.0</td>
      <td>Yes</td>
      <td>33.819519</td>
      <td>38.558298</td>
      <td>High_spent_Medium_value_payments</td>
      <td>363.281016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5718</th>
      <td>7894</td>
      <td>Teacher</td>
      <td>99868.830</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>Auto Loan, Credit-Builder Loan, and Auto Loan</td>
      <td>5</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>693.76</td>
      <td>30.253597</td>
      <td>263.0</td>
      <td>No</td>
      <td>146.701253</td>
      <td>838.623220</td>
      <td>Low_spent_Small_value_payments</td>
      <td>137.915778</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12415</th>
      <td>7901</td>
      <td>Entrepreneur</td>
      <td>64363.920</td>
      <td>4</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
      <td>Personal Loan, Credit-Builder Loan, Auto Loan,...</td>
      <td>25</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>978.79</td>
      <td>30.205522</td>
      <td>110.0</td>
      <td>Yes</td>
      <td>176.843978</td>
      <td>211.321489</td>
      <td>High_spent_Medium_value_payments</td>
      <td>423.000533</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1414</th>
      <td>7935</td>
      <td>Developer</td>
      <td>116809.000</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>Debt Consolidation Loan, Credit-Builder Loan, ...</td>
      <td>2</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1312.44</td>
      <td>34.458738</td>
      <td>219.0</td>
      <td>No</td>
      <td>191.675705</td>
      <td>190.976717</td>
      <td>High_spent_Large_value_payments</td>
      <td>838.555911</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1258</th>
      <td>7980</td>
      <td>Scientist</td>
      <td>44941.950</td>
      <td>4</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>Payday Loan</td>
      <td>0</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>1150.28</td>
      <td>27.894834</td>
      <td>367.0</td>
      <td>No</td>
      <td>22.434725</td>
      <td>133.727501</td>
      <td>!@9#%8</td>
      <td>508.454024</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7445</th>
      <td>8035</td>
      <td>Doctor</td>
      <td>32753.050</td>
      <td>2</td>
      <td>7</td>
      <td>6</td>
      <td>4</td>
      <td>Credit-Builder Loan, Debt Consolidation Loan, ...</td>
      <td>2</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>1300.30</td>
      <td>36.662384</td>
      <td>359.0</td>
      <td>No</td>
      <td>79.182771</td>
      <td>63.646267</td>
      <td>!@9#%8</td>
      <td>400.513046</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10824</th>
      <td>8052</td>
      <td>Manager</td>
      <td>35820.620</td>
      <td>0</td>
      <td>6</td>
      <td>8</td>
      <td>4</td>
      <td>Student Loan, Not Specified, Student Loan, and...</td>
      <td>10</td>
      <td>10.0</td>
      <td>3.0</td>
      <td>731.26</td>
      <td>26.763490</td>
      <td>237.0</td>
      <td>No</td>
      <td>87.981091</td>
      <td>169.322300</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>298.501775</td>
      <td>2</td>
    </tr>
    <tr>
      <th>857</th>
      <td>8080</td>
      <td>Entrepreneur</td>
      <td>62835.080</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>Home Equity Loan, and Debt Consolidation Loan</td>
      <td>10</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>306.85</td>
      <td>40.859818</td>
      <td>392.0</td>
      <td>No</td>
      <td>67.384074</td>
      <td>181.104372</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>577.937220</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4233</th>
      <td>8081</td>
      <td>Accountant</td>
      <td>19609.380</td>
      <td>9</td>
      <td>7</td>
      <td>23</td>
      <td>8</td>
      <td>Payday Loan, Mortgage Loan, Home Equity Loan, ...</td>
      <td>16</td>
      <td>23.0</td>
      <td>12.0</td>
      <td>4186.04</td>
      <td>25.656993</td>
      <td>62.0</td>
      <td>Yes</td>
      <td>87.281543</td>
      <td>93.293367</td>
      <td>Low_spent_Small_value_payments</td>
      <td>276.936589</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7108</th>
      <td>8172</td>
      <td>Doctor</td>
      <td>23838.090</td>
      <td>5</td>
      <td>6</td>
      <td>13</td>
      <td>773</td>
      <td>Debt Consolidation Loan, Payday Loan, Home Equ...</td>
      <td>24</td>
      <td>10.0</td>
      <td>7.0</td>
      <td>802.30</td>
      <td>31.348708</td>
      <td>358.0</td>
      <td>Yes</td>
      <td>53.308099</td>
      <td>10000.000000</td>
      <td>Low_spent_Small_value_payments</td>
      <td>232.429877</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4046</th>
      <td>8179</td>
      <td>Scientist</td>
      <td>49847.550</td>
      <td>9</td>
      <td>1384</td>
      <td>18</td>
      <td>3</td>
      <td>Home Equity Loan, Personal Loan, and Student Loan</td>
      <td>21</td>
      <td>18.0</td>
      <td>8.0</td>
      <td>2173.47</td>
      <td>39.903631</td>
      <td>233.0</td>
      <td>Yes</td>
      <td>71.675700</td>
      <td>318.284663</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>278.535887</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10197</th>
      <td>8198</td>
      <td>Journalist</td>
      <td>20488.290</td>
      <td>8</td>
      <td>5</td>
      <td>33</td>
      <td>9</td>
      <td>Auto Loan, Home Equity Loan, Home Equity Loan,...</td>
      <td>56</td>
      <td>18.0</td>
      <td>7.0</td>
      <td>3218.07</td>
      <td>35.075428</td>
      <td>92.0</td>
      <td>Yes</td>
      <td>131.465294</td>
      <td>122.316046</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>207.354411</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5788</th>
      <td>8246</td>
      <td>Accountant</td>
      <td>42900.210</td>
      <td>7</td>
      <td>4</td>
      <td>17</td>
      <td>4</td>
      <td>Personal Loan, Payday Loan, Mortgage Loan, and...</td>
      <td>18</td>
      <td>15.0</td>
      <td>4.0</td>
      <td>2696.09</td>
      <td>31.455247</td>
      <td>117.0</td>
      <td>Yes</td>
      <td>111.209311</td>
      <td>150.713217</td>
      <td>Low_spent_Small_value_payments</td>
      <td>376.079222</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2725</th>
      <td>8249</td>
      <td>Developer</td>
      <td>35372.360</td>
      <td>8</td>
      <td>5</td>
      <td>25</td>
      <td>9</td>
      <td>Home Equity Loan, Auto Loan, Mortgage Loan, Au...</td>
      <td>15</td>
      <td>24.0</td>
      <td>6.0</td>
      <td>3850.97</td>
      <td>31.673174</td>
      <td>85.0</td>
      <td>Yes</td>
      <td>173.241966</td>
      <td>80.806393</td>
      <td>High_spent_Small_value_payments</td>
      <td>292.521308</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11176</th>
      <td>8279</td>
      <td>_______</td>
      <td>37443.130</td>
      <td>2</td>
      <td>4</td>
      <td>7</td>
      <td>0</td>
      <td>NaN</td>
      <td>13</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>843.53</td>
      <td>34.062221</td>
      <td>302.0</td>
      <td>No</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>High_spent_Small_value_payments</td>
      <td>490.572275</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4738</th>
      <td>8306</td>
      <td>Developer</td>
      <td>27647.080</td>
      <td>7</td>
      <td>6</td>
      <td>13</td>
      <td>5</td>
      <td>Not Specified, Credit-Builder Loan, Mortgage L...</td>
      <td>17</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>159.63</td>
      <td>26.757773</td>
      <td>62.0</td>
      <td>Yes</td>
      <td>100.740203</td>
      <td>10000.000000</td>
      <td>High_spent_Small_value_payments</td>
      <td>294.462237</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8284</th>
      <td>8348</td>
      <td>Accountant</td>
      <td>19323.400</td>
      <td>10</td>
      <td>5</td>
      <td>18</td>
      <td>8</td>
      <td>Debt Consolidation Loan, Debt Consolidation Lo...</td>
      <td>48</td>
      <td>15.0</td>
      <td>7.0</td>
      <td>3033.25</td>
      <td>30.197723</td>
      <td>100.0</td>
      <td>Yes</td>
      <td>99.101347</td>
      <td>110.085452</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>245.741535</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9384</th>
      <td>8403</td>
      <td>Developer</td>
      <td>7756.465</td>
      <td>10</td>
      <td>7</td>
      <td>19</td>
      <td>2</td>
      <td>Payday Loan, and Student Loan</td>
      <td>45</td>
      <td>21.0</td>
      <td>11.0</td>
      <td>2338.09</td>
      <td>25.301853</td>
      <td>67.0</td>
      <td>Yes</td>
      <td>9.682065</td>
      <td>NaN</td>
      <td>High_spent_Medium_value_payments</td>
      <td>270.333736</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7630</th>
      <td>8409</td>
      <td>Lawyer</td>
      <td>34413.760</td>
      <td>6</td>
      <td>5</td>
      <td>8</td>
      <td>5</td>
      <td>Home Equity Loan, Home Equity Loan, Home Equit...</td>
      <td>23</td>
      <td>20.0</td>
      <td>6.0</td>
      <td>113.06</td>
      <td>39.139526</td>
      <td>69.0</td>
      <td>Yes</td>
      <td>74.328709</td>
      <td>37.339760</td>
      <td>High_spent_Large_value_payments</td>
      <td>420.012864</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12472</th>
      <td>8425</td>
      <td>Writer</td>
      <td>18512.970</td>
      <td>7</td>
      <td>5</td>
      <td>18</td>
      <td>3</td>
      <td>Student Loan, Student Loan, and Mortgage Loan</td>
      <td>15</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>1366.56</td>
      <td>29.253092</td>
      <td>131.0</td>
      <td>Yes</td>
      <td>24.621173</td>
      <td>63.282651</td>
      <td>High_spent_Medium_value_payments</td>
      <td>311.570927</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11218</th>
      <td>8481</td>
      <td>Journalist</td>
      <td>15874.010</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>12</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1173.38</td>
      <td>24.443887</td>
      <td>380.0</td>
      <td>No</td>
      <td>0.000000</td>
      <td>53.610174</td>
      <td>High_spent_Small_value_payments</td>
      <td>311.373243</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12439</th>
      <td>8490</td>
      <td>Lawyer</td>
      <td>150131.680</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>NaN</td>
      <td>8</td>
      <td>-2.0</td>
      <td>0.0</td>
      <td>1138.36</td>
      <td>30.013470</td>
      <td>376.0</td>
      <td>No</td>
      <td>0.000000</td>
      <td>949.847265</td>
      <td>Low_spent_Small_value_payments</td>
      <td>599.850069</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9255</th>
      <td>8587</td>
      <td>Journalist</td>
      <td>28286.240</td>
      <td>4</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>Mortgage Loan</td>
      <td>18</td>
      <td>16.0</td>
      <td>4.0</td>
      <td>1406.94</td>
      <td>33.599043</td>
      <td>350.0</td>
      <td>No</td>
      <td>17.431672</td>
      <td>41.114532</td>
      <td>High_spent_Medium_value_payments</td>
      <td>418.772462</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2963</th>
      <td>8592</td>
      <td>_______</td>
      <td>81815.020</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>Mortgage Loan</td>
      <td>4</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1434.75</td>
      <td>28.645438</td>
      <td>394.0</td>
      <td>No</td>
      <td>53.927785</td>
      <td>277.263979</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>637.300069</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
sns.boxplot(y=credit_df['Age'])
```




    <AxesSubplot:ylabel='Age'>




![png](output_24_1.png)



```python
credit_df[credit_df['Age']>90].sort_values('Age')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4781</th>
      <td>95</td>
      <td>Engineer</td>
      <td>46162.62</td>
      <td>10</td>
      <td>5</td>
      <td>16</td>
      <td>2</td>
      <td>Personal Loan, and Debt Consolidation Loan</td>
      <td>43</td>
      <td>19.0</td>
      <td>6.0</td>
      <td>1788.63</td>
      <td>35.386419</td>
      <td>185.0</td>
      <td>Yes</td>
      <td>65.956819</td>
      <td>288.645844</td>
      <td>Low_spent_Small_value_payments</td>
      <td>290.285837</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3911</th>
      <td>102</td>
      <td>Musician</td>
      <td>38460.28</td>
      <td>6</td>
      <td>9</td>
      <td>16</td>
      <td>7</td>
      <td>Personal Loan, Personal Loan, Home Equity Loan...</td>
      <td>56</td>
      <td>16.0</td>
      <td>11.0</td>
      <td>4106.50</td>
      <td>26.537577</td>
      <td>73.0</td>
      <td>Yes</td>
      <td>179.135821</td>
      <td>267.336505</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>157.630007</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2416</th>
      <td>126</td>
      <td>Teacher</td>
      <td>22050.56</td>
      <td>5</td>
      <td>4</td>
      <td>12</td>
      <td>1</td>
      <td>Home Equity Loan</td>
      <td>5</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>37.42</td>
      <td>28.956967</td>
      <td>387.0</td>
      <td>NM</td>
      <td>13.485884</td>
      <td>NaN</td>
      <td>High_spent_Medium_value_payments</td>
      <td>359.927004</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7418</th>
      <td>169</td>
      <td>Doctor</td>
      <td>50109.76</td>
      <td>6</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>Personal Loan</td>
      <td>16</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>893.62</td>
      <td>27.560776</td>
      <td>191.0</td>
      <td>NM</td>
      <td>22.847438</td>
      <td>351.547678</td>
      <td>Low_spent_Large_value_payments</td>
      <td>331.086217</td>
      <td>2</td>
    </tr>
    <tr>
      <th>952</th>
      <td>181</td>
      <td>_______</td>
      <td>87957.02</td>
      <td>2</td>
      <td>5</td>
      <td>9</td>
      <td>4</td>
      <td>Home Equity Loan, Auto Loan, Credit-Builder Lo...</td>
      <td>9</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>811.01</td>
      <td>41.470014</td>
      <td>231.0</td>
      <td>No</td>
      <td>195.913703</td>
      <td>265.660815</td>
      <td>High_spent_Medium_value_payments</td>
      <td>533.800649</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12472</th>
      <td>8425</td>
      <td>Writer</td>
      <td>18512.97</td>
      <td>7</td>
      <td>5</td>
      <td>18</td>
      <td>3</td>
      <td>Student Loan, Student Loan, and Mortgage Loan</td>
      <td>15</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>1366.56</td>
      <td>29.253092</td>
      <td>131.0</td>
      <td>Yes</td>
      <td>24.621173</td>
      <td>63.282651</td>
      <td>High_spent_Medium_value_payments</td>
      <td>311.570927</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11218</th>
      <td>8481</td>
      <td>Journalist</td>
      <td>15874.01</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>12</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>1173.38</td>
      <td>24.443887</td>
      <td>380.0</td>
      <td>No</td>
      <td>0.000000</td>
      <td>53.610174</td>
      <td>High_spent_Small_value_payments</td>
      <td>311.373243</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12439</th>
      <td>8490</td>
      <td>Lawyer</td>
      <td>150131.68</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>NaN</td>
      <td>8</td>
      <td>-2.0</td>
      <td>0.0</td>
      <td>1138.36</td>
      <td>30.013470</td>
      <td>376.0</td>
      <td>No</td>
      <td>0.000000</td>
      <td>949.847265</td>
      <td>Low_spent_Small_value_payments</td>
      <td>599.850069</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9255</th>
      <td>8587</td>
      <td>Journalist</td>
      <td>28286.24</td>
      <td>4</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>Mortgage Loan</td>
      <td>18</td>
      <td>16.0</td>
      <td>4.0</td>
      <td>1406.94</td>
      <td>33.599043</td>
      <td>350.0</td>
      <td>No</td>
      <td>17.431672</td>
      <td>41.114532</td>
      <td>High_spent_Medium_value_payments</td>
      <td>418.772462</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2963</th>
      <td>8592</td>
      <td>_______</td>
      <td>81815.02</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>Mortgage Loan</td>
      <td>4</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1434.75</td>
      <td>28.645438</td>
      <td>394.0</td>
      <td>No</td>
      <td>53.927785</td>
      <td>277.263979</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>637.300069</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>261 rows × 20 columns</p>
</div>




```python
credit_df = credit_df[credit_df['Age']<120]
```


```python
credit_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12126.000000</td>
      <td>1.212600e+04</td>
      <td>12126.000000</td>
      <td>12126.000000</td>
      <td>12126.000000</td>
      <td>12126.000000</td>
      <td>12126.000000</td>
      <td>11304.000000</td>
      <td>11892.000000</td>
      <td>12126.000000</td>
      <td>12126.000000</td>
      <td>11045.000000</td>
      <td>12126.000000</td>
      <td>11584.000000</td>
      <td>11995.000000</td>
      <td>12126.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>33.049398</td>
      <td>1.897604e+05</td>
      <td>17.275606</td>
      <td>21.458601</td>
      <td>68.507917</td>
      <td>3.179861</td>
      <td>21.053604</td>
      <td>31.464084</td>
      <td>24.994871</td>
      <td>1426.321231</td>
      <td>32.293466</td>
      <td>217.614396</td>
      <td>1308.972585</td>
      <td>641.812701</td>
      <td>406.077932</td>
      <td>0.870856</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10.810043</td>
      <td>1.486221e+06</td>
      <td>118.546216</td>
      <td>122.910157</td>
      <td>453.592030</td>
      <td>64.030581</td>
      <td>14.857112</td>
      <td>230.020040</td>
      <td>185.478101</td>
      <td>1155.255348</td>
      <td>5.084805</td>
      <td>99.405014</td>
      <td>8131.974016</td>
      <td>2059.907639</td>
      <td>218.484165</td>
      <td>0.653729</td>
    </tr>
    <tr>
      <th>min</th>
      <td>14.000000</td>
      <td>7.005930e+03</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>-5.000000</td>
      <td>-3.000000</td>
      <td>0.000000</td>
      <td>0.230000</td>
      <td>20.992914</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.088628</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>24.000000</td>
      <td>1.945750e+04</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>565.967500</td>
      <td>28.118929</td>
      <td>141.000000</td>
      <td>29.275040</td>
      <td>73.698246</td>
      <td>271.752715</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.000000</td>
      <td>3.765508e+04</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>13.000000</td>
      <td>3.000000</td>
      <td>18.000000</td>
      <td>14.000000</td>
      <td>4.000000</td>
      <td>1166.555000</td>
      <td>32.285050</td>
      <td>215.000000</td>
      <td>66.196875</td>
      <td>134.363758</td>
      <td>337.123394</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>41.000000</td>
      <td>7.305204e+04</td>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>20.000000</td>
      <td>5.000000</td>
      <td>28.000000</td>
      <td>18.000000</td>
      <td>8.000000</td>
      <td>1945.677500</td>
      <td>36.452073</td>
      <td>297.000000</td>
      <td>149.873130</td>
      <td>265.384383</td>
      <td>474.903731</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>102.000000</td>
      <td>2.365819e+07</td>
      <td>1779.000000</td>
      <td>1479.000000</td>
      <td>5788.000000</td>
      <td>1496.000000</td>
      <td>67.000000</td>
      <td>4388.000000</td>
      <td>2592.000000</td>
      <td>4998.070000</td>
      <td>49.564519</td>
      <td>397.000000</td>
      <td>82122.000000</td>
      <td>10000.000000</td>
      <td>1602.040519</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
len(credit_df[credit_df['Num_Bank_Accounts']>10])/len(credit_df)
```




    0.013029853207982847




```python
credit_df=credit_df[credit_df['Num_Bank_Accounts']<=10]
```


```python
len(credit_df[credit_df['Num_Credit_Card']>10])/len(credit_df)
```




    0.022142379679144383




```python
credit_df=credit_df[credit_df['Num_Credit_Card']<=10]
```


```python
credit_df = credit_df[credit_df['Interest_Rate']<=40]
```


```python
credit_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>11487.000000</td>
      <td>1.148700e+04</td>
      <td>11487.000000</td>
      <td>11487.000000</td>
      <td>11487.000000</td>
      <td>11487.000000</td>
      <td>11487.000000</td>
      <td>10695.000000</td>
      <td>11270.000000</td>
      <td>11487.000000</td>
      <td>11487.000000</td>
      <td>10454.000000</td>
      <td>11487.000000</td>
      <td>10974.000000</td>
      <td>11363.000000</td>
      <td>11487.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>33.049534</td>
      <td>1.866684e+05</td>
      <td>5.378950</td>
      <td>5.537564</td>
      <td>14.581788</td>
      <td>3.085836</td>
      <td>21.072691</td>
      <td>32.148481</td>
      <td>25.614907</td>
      <td>1428.211763</td>
      <td>32.274850</td>
      <td>217.182227</td>
      <td>1309.892277</td>
      <td>643.294691</td>
      <td>405.462098</td>
      <td>0.868982</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10.807228</td>
      <td>1.473331e+06</td>
      <td>2.592557</td>
      <td>2.069015</td>
      <td>8.770185</td>
      <td>63.612514</td>
      <td>14.868582</td>
      <td>235.577742</td>
      <td>188.958957</td>
      <td>1156.852697</td>
      <td>5.081655</td>
      <td>99.618121</td>
      <td>8148.091946</td>
      <td>2063.815555</td>
      <td>217.887346</td>
      <td>0.653006</td>
    </tr>
    <tr>
      <th>min</th>
      <td>14.000000</td>
      <td>7.005930e+03</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>-5.000000</td>
      <td>-3.000000</td>
      <td>0.000000</td>
      <td>0.230000</td>
      <td>20.992914</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.088628</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>24.000000</td>
      <td>1.939846e+04</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>7.000000</td>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>565.410000</td>
      <td>28.109912</td>
      <td>140.000000</td>
      <td>29.601005</td>
      <td>73.162675</td>
      <td>271.686486</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.000000</td>
      <td>3.747152e+04</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>13.000000</td>
      <td>3.000000</td>
      <td>18.000000</td>
      <td>14.000000</td>
      <td>4.000000</td>
      <td>1166.640000</td>
      <td>32.257865</td>
      <td>215.000000</td>
      <td>66.158038</td>
      <td>133.820509</td>
      <td>336.822178</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>41.000000</td>
      <td>7.289110e+04</td>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>20.000000</td>
      <td>5.000000</td>
      <td>28.000000</td>
      <td>18.000000</td>
      <td>8.000000</td>
      <td>1951.100000</td>
      <td>36.402664</td>
      <td>297.000000</td>
      <td>149.533496</td>
      <td>263.669812</td>
      <td>474.566180</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>102.000000</td>
      <td>2.365819e+07</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>34.000000</td>
      <td>1496.000000</td>
      <td>67.000000</td>
      <td>4388.000000</td>
      <td>2592.000000</td>
      <td>4998.070000</td>
      <td>49.564519</td>
      <td>397.000000</td>
      <td>82122.000000</td>
      <td>10000.000000</td>
      <td>1602.040519</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
sns.boxplot(y=credit_df['Num_of_Loan'])
```




    <AxesSubplot:ylabel='Num_of_Loan'>




![png](output_34_1.png)



```python
credit_df=credit_df[credit_df['Num_of_Loan']>=0]
```


```python
len(credit_df[credit_df['Num_of_Loan']>20])
```




    60




```python
credit_df = credit_df[credit_df['Num_of_Loan']<=20]
```


```python
credit_df.sort_values('Delay_from_due_date',ascending=False).head(30)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4176</th>
      <td>35</td>
      <td>_______</td>
      <td>41077.120</td>
      <td>9</td>
      <td>7</td>
      <td>29</td>
      <td>6</td>
      <td>Debt Consolidation Loan, Debt Consolidation Lo...</td>
      <td>67</td>
      <td>20.0</td>
      <td>11.0</td>
      <td>1507.89</td>
      <td>37.208682</td>
      <td>113.0</td>
      <td>Yes</td>
      <td>199.584000</td>
      <td>52.029644</td>
      <td>High_spent_Large_value_payments</td>
      <td>327.395689</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6169</th>
      <td>44</td>
      <td>Writer</td>
      <td>82934.760</td>
      <td>7</td>
      <td>9</td>
      <td>20</td>
      <td>6</td>
      <td>Personal Loan, Mortgage Loan, Auto Loan, Home ...</td>
      <td>67</td>
      <td>22.0</td>
      <td>8.0</td>
      <td>3519.93</td>
      <td>37.294328</td>
      <td>136.0</td>
      <td>Yes</td>
      <td>266.155814</td>
      <td>126.089131</td>
      <td>High_spent_Small_value_payments</td>
      <td>528.878055</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2831</th>
      <td>16</td>
      <td>Mechanic</td>
      <td>16701.540</td>
      <td>7</td>
      <td>6</td>
      <td>26</td>
      <td>5</td>
      <td>Not Specified, Personal Loan, Payday Loan, Not...</td>
      <td>67</td>
      <td>16.0</td>
      <td>10.0</td>
      <td>3356.86</td>
      <td>26.584542</td>
      <td>41.0</td>
      <td>Yes</td>
      <td>45.012674</td>
      <td>141.718752</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>248.848074</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3858</th>
      <td>28</td>
      <td>Accountant</td>
      <td>7711.540</td>
      <td>8</td>
      <td>7</td>
      <td>24</td>
      <td>9</td>
      <td>Not Specified, Home Equity Loan, Auto Loan, Mo...</td>
      <td>67</td>
      <td>20.0</td>
      <td>6.0</td>
      <td>2929.44</td>
      <td>32.030617</td>
      <td>31.0</td>
      <td>NM</td>
      <td>44.853589</td>
      <td>48.379814</td>
      <td>!@9#%8</td>
      <td>264.729431</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1351</th>
      <td>20</td>
      <td>Engineer</td>
      <td>15838.800</td>
      <td>10</td>
      <td>8</td>
      <td>23</td>
      <td>6</td>
      <td>Payday Loan, Payday Loan, Auto Loan, Debt Cons...</td>
      <td>66</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>2289.44</td>
      <td>38.452106</td>
      <td>109.0</td>
      <td>Yes</td>
      <td>49.170217</td>
      <td>90.984642</td>
      <td>Low_spent_Small_value_payments</td>
      <td>291.435141</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6860</th>
      <td>19</td>
      <td>Accountant</td>
      <td>14920.970</td>
      <td>6</td>
      <td>10</td>
      <td>16</td>
      <td>2</td>
      <td>Auto Loan, and Student Loan</td>
      <td>66</td>
      <td>13.0</td>
      <td>12.0</td>
      <td>1288.58</td>
      <td>26.772755</td>
      <td>155.0</td>
      <td>Yes</td>
      <td>19.909512</td>
      <td>72.116079</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>330.415826</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10168</th>
      <td>44</td>
      <td>Architect</td>
      <td>17077.400</td>
      <td>9</td>
      <td>10</td>
      <td>29</td>
      <td>5</td>
      <td>Home Equity Loan, Credit-Builder Loan, Credit-...</td>
      <td>66</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>2577.55</td>
      <td>30.297278</td>
      <td>177.0</td>
      <td>Yes</td>
      <td>64.171887</td>
      <td>64.705506</td>
      <td>High_spent_Medium_value_payments</td>
      <td>279.434274</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12179</th>
      <td>18</td>
      <td>Teacher</td>
      <td>14134.260</td>
      <td>6</td>
      <td>7</td>
      <td>30</td>
      <td>2</td>
      <td>Student Loan, and Payday Loan</td>
      <td>65</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1289.12</td>
      <td>31.090137</td>
      <td>98.0</td>
      <td>Yes</td>
      <td>17.601400</td>
      <td>69.311082</td>
      <td>High_spent_Small_value_payments</td>
      <td>287.373017</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4933</th>
      <td>41</td>
      <td>Engineer</td>
      <td>15551.680</td>
      <td>7</td>
      <td>9</td>
      <td>32</td>
      <td>7</td>
      <td>Personal Loan, Mortgage Loan, Not Specified, P...</td>
      <td>65</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>1660.20</td>
      <td>34.199065</td>
      <td>NaN</td>
      <td>Yes</td>
      <td>86.803940</td>
      <td>93.720320</td>
      <td>Low_spent_Small_value_payments</td>
      <td>263.773073</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8282</th>
      <td>29</td>
      <td>Journalist</td>
      <td>14269.420</td>
      <td>10</td>
      <td>6</td>
      <td>28</td>
      <td>5</td>
      <td>Auto Loan, Personal Loan, Personal Loan, Home ...</td>
      <td>65</td>
      <td>23.0</td>
      <td>9.0</td>
      <td>3223.66</td>
      <td>24.129068</td>
      <td>29.0</td>
      <td>Yes</td>
      <td>33.947418</td>
      <td>46.751317</td>
      <td>Low_spent_Small_value_payments</td>
      <td>344.213098</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6060</th>
      <td>31</td>
      <td>_______</td>
      <td>46297.440</td>
      <td>7</td>
      <td>8</td>
      <td>26</td>
      <td>9</td>
      <td>Student Loan, Student Loan, Personal Loan, Mor...</td>
      <td>64</td>
      <td>18.0</td>
      <td>12.0</td>
      <td>4745.81</td>
      <td>34.600673</td>
      <td>29.0</td>
      <td>Yes</td>
      <td>210.122364</td>
      <td>10000.000000</td>
      <td>High_spent_Medium_value_payments</td>
      <td>263.476824</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6675</th>
      <td>14</td>
      <td>Mechanic</td>
      <td>8555.320</td>
      <td>9</td>
      <td>9</td>
      <td>24</td>
      <td>4</td>
      <td>Payday Loan, Payday Loan, Auto Loan, and Auto ...</td>
      <td>64</td>
      <td>20.0</td>
      <td>7.0</td>
      <td>2457.42</td>
      <td>30.524887</td>
      <td>NaN</td>
      <td>Yes</td>
      <td>24.970844</td>
      <td>11.624032</td>
      <td>High_spent_Medium_value_payments</td>
      <td>283.699458</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7974</th>
      <td>44</td>
      <td>Media_Manager</td>
      <td>56414.520</td>
      <td>6</td>
      <td>6</td>
      <td>34</td>
      <td>6</td>
      <td>Student Loan, Not Specified, Student Loan, Cre...</td>
      <td>64</td>
      <td>22.0</td>
      <td>11.0</td>
      <td>2476.44</td>
      <td>28.532637</td>
      <td>124.0</td>
      <td>Yes</td>
      <td>183.045313</td>
      <td>42.854563</td>
      <td>High_spent_Large_value_payments</td>
      <td>463.521124</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6279</th>
      <td>20</td>
      <td>Developer</td>
      <td>83204.520</td>
      <td>8</td>
      <td>10</td>
      <td>29</td>
      <td>5</td>
      <td>Student Loan, Personal Loan, Debt Consolidatio...</td>
      <td>64</td>
      <td>17.0</td>
      <td>12.0</td>
      <td>3388.37</td>
      <td>40.135846</td>
      <td>149.0</td>
      <td>Yes</td>
      <td>276.874813</td>
      <td>114.576749</td>
      <td>High_spent_Large_value_payments</td>
      <td>531.719438</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2934</th>
      <td>27</td>
      <td>Engineer</td>
      <td>8761.630</td>
      <td>10</td>
      <td>7</td>
      <td>26</td>
      <td>3</td>
      <td>Mortgage Loan, Debt Consolidation Loan, and Pe...</td>
      <td>64</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>1968.72</td>
      <td>33.466910</td>
      <td>121.0</td>
      <td>Yes</td>
      <td>12.858404</td>
      <td>51.458737</td>
      <td>Low_spent_Large_value_payments</td>
      <td>271.696442</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4131</th>
      <td>35</td>
      <td>_______</td>
      <td>58192.440</td>
      <td>9</td>
      <td>8</td>
      <td>31</td>
      <td>7</td>
      <td>Not Specified, Payday Loan, Personal Loan, Not...</td>
      <td>64</td>
      <td>13.0</td>
      <td>11.0</td>
      <td>3334.81</td>
      <td>35.941159</td>
      <td>67.0</td>
      <td>Yes</td>
      <td>204.304865</td>
      <td>217.860517</td>
      <td>Low_spent_Small_value_payments</td>
      <td>329.771618</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4115</th>
      <td>41</td>
      <td>Accountant</td>
      <td>9795.070</td>
      <td>7</td>
      <td>8</td>
      <td>29</td>
      <td>6</td>
      <td>Debt Consolidation Loan, Auto Loan, Personal L...</td>
      <td>64</td>
      <td>18.0</td>
      <td>12.0</td>
      <td>2065.27</td>
      <td>35.712589</td>
      <td>64.0</td>
      <td>Yes</td>
      <td>42.605317</td>
      <td>59.573221</td>
      <td>Low_spent_Small_value_payments</td>
      <td>246.447045</td>
      <td>0</td>
    </tr>
    <tr>
      <th>241</th>
      <td>40</td>
      <td>Lawyer</td>
      <td>9141.630</td>
      <td>9</td>
      <td>6</td>
      <td>33</td>
      <td>5</td>
      <td>Mortgage Loan, Student Loan, Payday Loan, Debt...</td>
      <td>64</td>
      <td>17.0</td>
      <td>12.0</td>
      <td>2506.45</td>
      <td>25.148187</td>
      <td>193.0</td>
      <td>Yes</td>
      <td>27.801129</td>
      <td>39.743679</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>292.235442</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9440</th>
      <td>40</td>
      <td>_______</td>
      <td>15907.910</td>
      <td>8</td>
      <td>6</td>
      <td>34</td>
      <td>5</td>
      <td>Personal Loan, Credit-Builder Loan, Debt Conso...</td>
      <td>64</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1424.12</td>
      <td>34.830986</td>
      <td>79.0</td>
      <td>Yes</td>
      <td>55.894362</td>
      <td>NaN</td>
      <td>Low_spent_Small_value_payments</td>
      <td>203.314907</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2250</th>
      <td>28</td>
      <td>Mechanic</td>
      <td>28575.400</td>
      <td>6</td>
      <td>10</td>
      <td>25</td>
      <td>8</td>
      <td>Mortgage Loan, Student Loan, Student Loan, Mor...</td>
      <td>64</td>
      <td>16.0</td>
      <td>12.0</td>
      <td>2641.74</td>
      <td>31.625112</td>
      <td>166.0</td>
      <td>Yes</td>
      <td>135.258101</td>
      <td>174.424844</td>
      <td>!@9#%8</td>
      <td>230.645388</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8833</th>
      <td>44</td>
      <td>Musician</td>
      <td>15599.880</td>
      <td>6</td>
      <td>8</td>
      <td>21</td>
      <td>6</td>
      <td>Mortgage Loan, Debt Consolidation Loan, Not Sp...</td>
      <td>64</td>
      <td>25.0</td>
      <td>6.0</td>
      <td>4384.60</td>
      <td>27.452929</td>
      <td>99.0</td>
      <td>Yes</td>
      <td>66.732286</td>
      <td>65.044359</td>
      <td>High_spent_Small_value_payments</td>
      <td>260.722355</td>
      <td>0</td>
    </tr>
    <tr>
      <th>908</th>
      <td>17</td>
      <td>Accountant</td>
      <td>49250.730</td>
      <td>9</td>
      <td>7</td>
      <td>21</td>
      <td>6</td>
      <td>Student Loan, Credit-Builder Loan, Auto Loan, ...</td>
      <td>64</td>
      <td>19.0</td>
      <td>12.0</td>
      <td>2231.92</td>
      <td>33.040583</td>
      <td>136.0</td>
      <td>NM</td>
      <td>206.501919</td>
      <td>148.795879</td>
      <td>High_spent_Medium_value_payments</td>
      <td>307.824951</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1132</th>
      <td>18</td>
      <td>Manager</td>
      <td>9734.325</td>
      <td>8</td>
      <td>10</td>
      <td>31</td>
      <td>4</td>
      <td>Credit-Builder Loan, Student Loan, Payday Loan...</td>
      <td>63</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>2558.01</td>
      <td>39.881596</td>
      <td>158.0</td>
      <td>Yes</td>
      <td>17.853985</td>
      <td>80.353612</td>
      <td>Low_spent_Large_value_payments</td>
      <td>259.411778</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11521</th>
      <td>36</td>
      <td>Entrepreneur</td>
      <td>16685.020</td>
      <td>9</td>
      <td>6</td>
      <td>22</td>
      <td>5</td>
      <td>Credit-Builder Loan, Student Loan, Not Specifi...</td>
      <td>63</td>
      <td>19.0</td>
      <td>10.0</td>
      <td>2298.18</td>
      <td>37.507210</td>
      <td>115.0</td>
      <td>NM</td>
      <td>35.188053</td>
      <td>87.981454</td>
      <td>High_spent_Small_value_payments</td>
      <td>290.472326</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>17</td>
      <td>Writer</td>
      <td>37976.680</td>
      <td>9</td>
      <td>9</td>
      <td>18</td>
      <td>7</td>
      <td>Auto Loan, Personal Loan, Student Loan, Person...</td>
      <td>63</td>
      <td>23.0</td>
      <td>12.0</td>
      <td>4505.10</td>
      <td>23.616905</td>
      <td>99.0</td>
      <td>Yes</td>
      <td>148.765699</td>
      <td>58.497056</td>
      <td>High_spent_Large_value_payments</td>
      <td>332.509578</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4488</th>
      <td>43</td>
      <td>Engineer</td>
      <td>64794.640</td>
      <td>7</td>
      <td>5</td>
      <td>31</td>
      <td>5</td>
      <td>Home Equity Loan, Debt Consolidation Loan, Hom...</td>
      <td>63</td>
      <td>22.0</td>
      <td>7.0</td>
      <td>2080.18</td>
      <td>27.381840</td>
      <td>200.0</td>
      <td>Yes</td>
      <td>267.941757</td>
      <td>138.556455</td>
      <td>High_spent_Large_value_payments</td>
      <td>400.057122</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5378</th>
      <td>30</td>
      <td>Scientist</td>
      <td>64674.200</td>
      <td>9</td>
      <td>7</td>
      <td>17</td>
      <td>6</td>
      <td>Credit-Builder Loan, Debt Consolidation Loan, ...</td>
      <td>63</td>
      <td>22.0</td>
      <td>12.0</td>
      <td>2374.96</td>
      <td>26.722658</td>
      <td>131.0</td>
      <td>Yes</td>
      <td>197.226883</td>
      <td>64.941053</td>
      <td>High_spent_Medium_value_payments</td>
      <td>555.383730</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7462</th>
      <td>19</td>
      <td>Engineer</td>
      <td>18796.030</td>
      <td>6</td>
      <td>8</td>
      <td>31</td>
      <td>7</td>
      <td>Mortgage Loan, Not Specified, Student Loan, Pe...</td>
      <td>63</td>
      <td>19.0</td>
      <td>10.0</td>
      <td>3051.99</td>
      <td>23.930778</td>
      <td>NaN</td>
      <td>NM</td>
      <td>68.978422</td>
      <td>111.984640</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>274.070521</td>
      <td>0</td>
    </tr>
    <tr>
      <th>769</th>
      <td>16</td>
      <td>Entrepreneur</td>
      <td>9889.575</td>
      <td>10</td>
      <td>10</td>
      <td>17</td>
      <td>2</td>
      <td>Debt Consolidation Loan, and Home Equity Loan</td>
      <td>63</td>
      <td>17.0</td>
      <td>9.0</td>
      <td>2142.54</td>
      <td>27.751275</td>
      <td>219.0</td>
      <td>Yes</td>
      <td>12.100552</td>
      <td>10000.000000</td>
      <td>Low_spent_Small_value_payments</td>
      <td>260.207420</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10339</th>
      <td>32</td>
      <td>_______</td>
      <td>10344.865</td>
      <td>10</td>
      <td>8</td>
      <td>22</td>
      <td>3</td>
      <td>Home Equity Loan, Payday Loan, and Personal Loan</td>
      <td>63</td>
      <td>19.0</td>
      <td>7.0</td>
      <td>2528.61</td>
      <td>29.543462</td>
      <td>122.0</td>
      <td>Yes</td>
      <td>14.493807</td>
      <td>42.595869</td>
      <td>Low_spent_Medium_value_payments</td>
      <td>319.817533</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df = credit_df[credit_df['Delay_from_due_date']>=0]
```


```python
credit_df = credit_df[credit_df['Num_of_Delayed_Payment']>=0]
```


```python
len(credit_df[credit_df['Num_of_Delayed_Payment']>50])
```




    80




```python
sns.boxplot(y=credit_df['Num_of_Delayed_Payment'])
```




    <AxesSubplot:ylabel='Num_of_Delayed_Payment'>




![png](output_42_1.png)



```python
credit_df = credit_df[credit_df['Num_of_Delayed_Payment']<=50]
```


```python
len(credit_df[credit_df['Num_Credit_Inquiries']>50])
```




    155




```python
credit_df = credit_df[credit_df['Num_Credit_Inquiries']<=50]
```


```python
credit_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 9660 entries, 0 to 12498
    Data columns (total 20 columns):
     #   Column                    Non-Null Count  Dtype  
    ---  ------                    --------------  -----  
     0   Age                       9660 non-null   int64  
     1   Occupation                9660 non-null   object 
     2   Annual_Income             9660 non-null   float64
     3   Num_Bank_Accounts         9660 non-null   int64  
     4   Num_Credit_Card           9660 non-null   int64  
     5   Interest_Rate             9660 non-null   int64  
     6   Num_of_Loan               9660 non-null   int64  
     7   Type_of_Loan              8585 non-null   object 
     8   Delay_from_due_date       9660 non-null   int64  
     9   Num_of_Delayed_Payment    9660 non-null   float64
     10  Num_Credit_Inquiries      9660 non-null   float64
     11  Outstanding_Debt          9660 non-null   float64
     12  Credit_Utilization_Ratio  9660 non-null   float64
     13  Credit_History_Age        8793 non-null   float64
     14  Payment_of_Min_Amount     9660 non-null   object 
     15  Total_EMI_per_month       9660 non-null   float64
     16  Amount_invested_monthly   9225 non-null   float64
     17  Payment_Behaviour         9660 non-null   object 
     18  Monthly_Balance           9558 non-null   float64
     19  Credit_Score              9660 non-null   int64  
    dtypes: float64(9), int64(7), object(4)
    memory usage: 1.5+ MB
    


```python
credit_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>9660.000000</td>
      <td>9.660000e+03</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>9660.000000</td>
      <td>8793.000000</td>
      <td>9660.000000</td>
      <td>9225.000000</td>
      <td>9558.000000</td>
      <td>9660.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>32.969979</td>
      <td>1.984231e+05</td>
      <td>5.413975</td>
      <td>5.550414</td>
      <td>14.705590</td>
      <td>3.571636</td>
      <td>21.348137</td>
      <td>13.475466</td>
      <td>5.006832</td>
      <td>1437.673160</td>
      <td>32.285210</td>
      <td>215.756966</td>
      <td>1328.819822</td>
      <td>642.501569</td>
      <td>403.961486</td>
      <td>0.857660</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10.830248</td>
      <td>1.537451e+06</td>
      <td>2.575006</td>
      <td>2.061646</td>
      <td>8.781544</td>
      <td>2.452730</td>
      <td>14.857853</td>
      <td>6.202865</td>
      <td>3.551079</td>
      <td>1161.314701</td>
      <td>5.088985</td>
      <td>99.500960</td>
      <td>8254.714563</td>
      <td>2062.710249</td>
      <td>215.936945</td>
      <td>0.648912</td>
    </tr>
    <tr>
      <th>min</th>
      <td>14.000000</td>
      <td>7.005930e+03</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.340000</td>
      <td>20.992914</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.088628</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>24.000000</td>
      <td>1.940238e+04</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>2.000000</td>
      <td>10.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>569.037500</td>
      <td>28.141744</td>
      <td>139.000000</td>
      <td>29.839082</td>
      <td>72.564027</td>
      <td>271.627256</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.000000</td>
      <td>3.782272e+04</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>13.000000</td>
      <td>3.000000</td>
      <td>18.000000</td>
      <td>14.000000</td>
      <td>4.000000</td>
      <td>1171.460000</td>
      <td>32.234851</td>
      <td>213.000000</td>
      <td>66.394433</td>
      <td>132.784300</td>
      <td>336.622520</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>41.000000</td>
      <td>7.264680e+04</td>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>20.000000</td>
      <td>5.000000</td>
      <td>28.000000</td>
      <td>18.000000</td>
      <td>8.000000</td>
      <td>1978.292500</td>
      <td>36.425730</td>
      <td>296.000000</td>
      <td>149.633087</td>
      <td>265.129082</td>
      <td>471.929318</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>102.000000</td>
      <td>2.365819e+07</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>34.000000</td>
      <td>19.000000</td>
      <td>67.000000</td>
      <td>28.000000</td>
      <td>12.000000</td>
      <td>4998.070000</td>
      <td>49.564519</td>
      <td>397.000000</td>
      <td>82122.000000</td>
      <td>10000.000000</td>
      <td>1602.040519</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df[credit_df['Type_of_Loan'].isna()]['Num_of_Loan'].unique()
```




    array([0], dtype=int64)




```python
credit_df['Type_of_Loan'] = credit_df['Type_of_Loan'].fillna('No_Loan')
```


```python
#그래프 분포가 가운데가 솟은 경우는 median으로 처리하면 좋음!
sns.displot(credit_df['Credit_History_Age'])
```




    <seaborn.axisgrid.FacetGrid at 0x1cbb97dcd60>




![png](output_50_1.png)



```python
sns.displot(credit_df['Amount_invested_monthly'])
```




    <seaborn.axisgrid.FacetGrid at 0x1cbb98007c0>




![png](output_51_1.png)



```python
sns.displot(credit_df['Monthly_Balance'])
```




    <seaborn.axisgrid.FacetGrid at 0x1cbbb4301f0>




![png](output_52_1.png)



```python
credit_df=credit_df.fillna(credit_df.median())
```

    C:\Users\MINUK\AppData\Local\Temp\ipykernel_15288\3735749249.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with 'numeric_only=None') is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
      credit_df=credit_df.fillna(credit_df.median())
    


```python
credit_df.isna().sum()
```




    Age                         0
    Occupation                  0
    Annual_Income               0
    Num_Bank_Accounts           0
    Num_Credit_Card             0
    Interest_Rate               0
    Num_of_Loan                 0
    Type_of_Loan                0
    Delay_from_due_date         0
    Num_of_Delayed_Payment      0
    Num_Credit_Inquiries        0
    Outstanding_Debt            0
    Credit_Utilization_Ratio    0
    Credit_History_Age          0
    Payment_of_Min_Amount       0
    Total_EMI_per_month         0
    Amount_invested_monthly     0
    Payment_Behaviour           0
    Monthly_Balance             0
    Credit_Score                0
    dtype: int64




```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23</td>
      <td>Scientist</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>Auto Loan, Credit-Builder Loan, Personal Loan,...</td>
      <td>3</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>265.0</td>
      <td>No</td>
      <td>49.574949</td>
      <td>80.415295</td>
      <td>High_spent_Small_value_payments</td>
      <td>312.494089</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28</td>
      <td>_______</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>Credit-Builder Loan</td>
      <td>3</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>319.0</td>
      <td>No</td>
      <td>18.816215</td>
      <td>104.291825</td>
      <td>Low_spent_Small_value_payments</td>
      <td>470.690627</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>_______</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>Auto Loan, Auto Loan, and Not Specified</td>
      <td>5</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>213.0</td>
      <td>No</td>
      <td>246.992320</td>
      <td>168.413703</td>
      <td>!@9#%8</td>
      <td>1043.315978</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54</td>
      <td>Entrepreneur</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>Not Specified</td>
      <td>0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>207.0</td>
      <td>No</td>
      <td>16.415452</td>
      <td>81.228859</td>
      <td>Low_spent_Large_value_payments</td>
      <td>433.604773</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>33</td>
      <td>Lawyer</td>
      <td>131313.40</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>Credit-Builder Loan, and Mortgage Loan</td>
      <td>0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>352.16</td>
      <td>32.200509</td>
      <td>367.0</td>
      <td>NM</td>
      <td>137.644605</td>
      <td>378.171253</td>
      <td>High_spent_Medium_value_payments</td>
      <td>858.462474</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df['Type_of_Loan'] = credit_df['Type_of_Loan'].str.replace('and ','')
```


```python
type_list = set(credit_df['Type_of_Loan'].str.split(', ').sum())
type_list
#중복된게 있음
```




    {'Auto Loan',
     'Credit-Builder Loan',
     'Debt Consolidation Loan',
     'Home Equity Loan',
     'Mortgage Loan',
     'No_Loan',
     'Not Specified',
     'Payday Loan',
     'Personal Loan',
     'Student Loan'}




```python
'apple' in ['apple','banana','orange']
```




    True




```python
credit_df['Type_of_Loan'] = credit_df['Type_of_Loan'].str.split(', ')
```


```python
for i in type_list:
    credit_df[i] = credit_df['Type_of_Loan'].apply(lambda x: 1 if i in x else 0)
```


```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Occupation</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Type_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Payment_of_Min_Amount</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Payment_Behaviour</th>
      <th>Monthly_Balance</th>
      <th>Credit_Score</th>
      <th>No_Loan</th>
      <th>Personal Loan</th>
      <th>Mortgage Loan</th>
      <th>Payday Loan</th>
      <th>Home Equity Loan</th>
      <th>Student Loan</th>
      <th>Debt Consolidation Loan</th>
      <th>Auto Loan</th>
      <th>Credit-Builder Loan</th>
      <th>Not Specified</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23</td>
      <td>Scientist</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>[Auto Loan, Credit-Builder Loan, Personal Loan...</td>
      <td>3</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>265.0</td>
      <td>No</td>
      <td>49.574949</td>
      <td>80.415295</td>
      <td>High_spent_Small_value_payments</td>
      <td>312.494089</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28</td>
      <td>_______</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>[Credit-Builder Loan]</td>
      <td>3</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>319.0</td>
      <td>No</td>
      <td>18.816215</td>
      <td>104.291825</td>
      <td>Low_spent_Small_value_payments</td>
      <td>470.690627</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>_______</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>[Auto Loan, Auto Loan, Not Specified]</td>
      <td>5</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>213.0</td>
      <td>No</td>
      <td>246.992320</td>
      <td>168.413703</td>
      <td>!@9#%8</td>
      <td>1043.315978</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54</td>
      <td>Entrepreneur</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>[Not Specified]</td>
      <td>0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>207.0</td>
      <td>No</td>
      <td>16.415452</td>
      <td>81.228859</td>
      <td>Low_spent_Large_value_payments</td>
      <td>433.604773</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>33</td>
      <td>Lawyer</td>
      <td>131313.40</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>[Credit-Builder Loan, Mortgage Loan]</td>
      <td>0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>352.16</td>
      <td>32.200509</td>
      <td>367.0</td>
      <td>NM</td>
      <td>137.644605</td>
      <td>378.171253</td>
      <td>High_spent_Medium_value_payments</td>
      <td>858.462474</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
credit_df.drop('Type_of_Loan',axis=1,inplace=True)
```


```python
credit_df['Occupation'].value_counts()
```




    _______          654
    Lawyer           646
    Mechanic         627
    Engineer         617
    Scientist        609
    Architect        606
    Developer        604
    Teacher          603
    Entrepreneur     596
    Musician         594
    Journalist       593
    Accountant       593
    Media_Manager    589
    Doctor           588
    Manager          578
    Writer           563
    Name: Occupation, dtype: int64




```python
credit_df['Occupation'] = credit_df['Occupation'].replace('_______','Unknown')
```


```python
credit_df['Occupation'].value_counts()
```




    Unknown          654
    Lawyer           646
    Mechanic         627
    Engineer         617
    Scientist        609
    Architect        606
    Developer        604
    Teacher          603
    Entrepreneur     596
    Musician         594
    Journalist       593
    Accountant       593
    Media_Manager    589
    Doctor           588
    Manager          578
    Writer           563
    Name: Occupation, dtype: int64




```python
credit_df['Payment_Behaviour'].value_counts()
```




    Low_spent_Small_value_payments      2405
    High_spent_Medium_value_payments    1744
    High_spent_Large_value_payments     1407
    Low_spent_Medium_value_payments     1334
    High_spent_Small_value_payments     1098
    Low_spent_Large_value_payments       954
    !@9#%8                               718
    Name: Payment_Behaviour, dtype: int64




```python
credit_df['Payment_Behaviour']= credit_df['Payment_Behaviour'].replace('!@9#%8','Unknown')
```


```python
credit_df['Payment_Behaviour'].value_counts()
```




    Low_spent_Small_value_payments      2405
    High_spent_Medium_value_payments    1744
    High_spent_Large_value_payments     1407
    Low_spent_Medium_value_payments     1334
    High_spent_Small_value_payments     1098
    Low_spent_Large_value_payments       954
    Unknown                              718
    Name: Payment_Behaviour, dtype: int64




```python
credit_df = pd.get_dummies(credit_df,columns={'Occupation','Payment_of_Min_Amount','Payment_Behaviour'})
```

    C:\Users\MINUK\AppData\Local\Temp\ipykernel_15288\1573211044.py:1: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
      credit_df = pd.get_dummies(credit_df,columns={'Occupation','Payment_of_Min_Amount','Payment_Behaviour'})
    


```python
credit_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Annual_Income</th>
      <th>Num_Bank_Accounts</th>
      <th>Num_Credit_Card</th>
      <th>Interest_Rate</th>
      <th>Num_of_Loan</th>
      <th>Delay_from_due_date</th>
      <th>Num_of_Delayed_Payment</th>
      <th>Num_Credit_Inquiries</th>
      <th>Outstanding_Debt</th>
      <th>Credit_Utilization_Ratio</th>
      <th>Credit_History_Age</th>
      <th>Total_EMI_per_month</th>
      <th>Amount_invested_monthly</th>
      <th>Monthly_Balance</th>
      <th>...</th>
      <th>Occupation_Architect</th>
      <th>Occupation_Developer</th>
      <th>Occupation_Doctor</th>
      <th>Occupation_Engineer</th>
      <th>Occupation_Entrepreneur</th>
      <th>Occupation_Journalist</th>
      <th>Occupation_Lawyer</th>
      <th>Occupation_Manager</th>
      <th>Occupation_Mechanic</th>
      <th>Occupation_Media_Manager</th>
      <th>Occupation_Musician</th>
      <th>Occupation_Scientist</th>
      <th>Occupation_Teacher</th>
      <th>Occupation_Unknown</th>
      <th>Occupation_Writer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23</td>
      <td>19114.12</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>809.98</td>
      <td>26.822620</td>
      <td>265.0</td>
      <td>49.574949</td>
      <td>80.415295</td>
      <td>312.494089</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28</td>
      <td>34847.84</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>605.03</td>
      <td>24.464031</td>
      <td>319.0</td>
      <td>18.816215</td>
      <td>104.291825</td>
      <td>470.690627</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>143162.64</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>5</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>1303.01</td>
      <td>28.616735</td>
      <td>213.0</td>
      <td>246.992320</td>
      <td>168.413703</td>
      <td>1043.315978</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54</td>
      <td>30689.89</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>632.46</td>
      <td>26.544229</td>
      <td>207.0</td>
      <td>16.415452</td>
      <td>81.228859</td>
      <td>433.604773</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>33</td>
      <td>131313.40</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>352.16</td>
      <td>32.200509</td>
      <td>367.0</td>
      <td>137.644605</td>
      <td>378.171253</td>
      <td>858.462474</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 52 columns</p>
</div>




```python
from sklearn.model_selection import train_test_split
```


```python
len(credit_df)
```




    9660




```python
X_train,X_test,y_train,y_test = train_test_split(credit_df.drop('Credit_Score',axis=1),credit_df['Credit_Score'],test_size=0.25,random_state=10)
```


```python
from lightgbm import LGBMClassifier
```


```python
base_model = LGBMClassifier(random_state=10)
```


```python
#lgbm은 decision tree와 random forest의 진화형
base_model.fit(X_train,y_train)
```




    LGBMClassifier(random_state=10)




```python
pred1= base_model.predict(X_test)
```


```python
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report,roc_auc_score
```


```python
accuracy_score(y_test,pred1)
```




    0.7221532091097308




```python
confusion_matrix(y_test,pred1)
```




    array([[ 497,  167,   34],
           [ 193, 1035,  110],
           [  10,  157,  212]], dtype=int64)




```python
print(classification_report(y_test,pred1))
```

                  precision    recall  f1-score   support
    
               0       0.71      0.71      0.71       698
               1       0.76      0.77      0.77      1338
               2       0.60      0.56      0.58       379
    
        accuracy                           0.72      2415
       macro avg       0.69      0.68      0.69      2415
    weighted avg       0.72      0.72      0.72      2415
    
    


```python
proba1 =base_model.predict_proba(X_test)
```


```python
proba1
```




    array([[9.54323650e-04, 3.28537904e-02, 9.66191886e-01],
           [2.82992298e-01, 5.57779189e-01, 1.59228513e-01],
           [9.77453940e-01, 2.25086723e-02, 3.73878678e-05],
           ...,
           [4.24216787e-01, 5.75627119e-01, 1.56093623e-04],
           [8.03024253e-01, 1.96865266e-01, 1.10480368e-04],
           [8.22718982e-02, 8.03303208e-01, 1.14424893e-01]])




```python
#이렇게 실행하면 에러남 roc_auc_score(y_test,proba1) ->3개 중에 선택하는거라 매개변수 다르게해야함
roc_auc_score(y_test,proba1,multi_class='ovr') # ovo: 데이터가 한쪽으로 치우친 경우에는 ovo사용
```




    0.8900998557981895




```python
from sklearn.model_selection import RandomizedSearchCV
```


```python
params = {
    'n_estimators':[100,300,500,1000], #트리 몇개까지 허용할지
    'max_depth':[-1,30,50,100], #얼마까지 내려갈건데
    'num_leaves':[5,10,20,50], # 맨 끝에 내려갈수 없는 최하위 자식을 몇개까지
    'learning_rate':[0.01,0.05,0.1,0.5] 
}
```


```python
lgbm = LGBMClassifier(random_state=10)
```


```python
rand_lgbm = RandomizedSearchCV(lgbm,params,n_iter=30,random_state=10)
```


```python
rand_lgbm.fit(X_train,y_train)
```




    RandomizedSearchCV(estimator=LGBMClassifier(random_state=10), n_iter=30,
                       param_distributions={'learning_rate': [0.01, 0.05, 0.1, 0.5],
                                            'max_depth': [-1, 30, 50, 100],
                                            'n_estimators': [100, 300, 500, 1000],
                                            'num_leaves': [5, 10, 20, 50]},
                       random_state=10)




```python
rand_lgbm.best_params_
```




    {'num_leaves': 20, 'n_estimators': 300, 'max_depth': 50, 'learning_rate': 0.01}




```python
proba2 = rand_lgbm.predict_proba(X_test)
```


```python
roc_auc_score(y_test,proba2,multi_class='ovr')
```




    0.898970790336609




```python

```
